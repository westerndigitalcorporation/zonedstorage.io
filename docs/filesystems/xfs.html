<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-filesystems/xfs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">XFS | Zoned Storage</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zonedstorage.io/docs/filesystems/xfs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="XFS | Zoned Storage"><meta data-rh="true" name="description" content="XFS is a widely used scalable enterprise file system that traces it&#x27;s root"><meta data-rh="true" property="og:description" content="XFS is a widely used scalable enterprise file system that traces it&#x27;s root"><link data-rh="true" rel="icon" href="/img/zs-logo.ico"><link data-rh="true" rel="canonical" href="https://zonedstorage.io/docs/filesystems/xfs"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/filesystems/xfs" hreflang="en"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/filesystems/xfs" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"XFS","item":"https://zonedstorage.io/docs/filesystems/xfs"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><link rel="stylesheet" href="/assets/css/styles.0fff285b.css">
<script src="/assets/js/runtime~main.6ff41505.js" defer="defer"></script>
<script src="/assets/js/main.69b7e4e5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Zoned Storage</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/introduction">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/getting-started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux">Linux Kernel Support</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/device-mapper">Device Mapper</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/filesystems">File Systems</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/filesystems">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/filesystems/xfs">XFS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/filesystems/btrfs">BTRFS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/filesystems/f2fs">F2FS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/filesystems/zonefs">zonefs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/applications">Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tools">Tools and Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tests">System Compliance Tests</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/benchmarking">Performance Benchmarking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/distributions/overview">Linux Distributions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">File Systems</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">XFS</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>XFS File System</h1></header>
<p><em>XFS</em> is a widely used scalable enterprise file system that traces it&#x27;s root
back to the IRIX operating system in the 1990s and is supported by all
major Linux distributions. <em>XFS</em> was originally designed for in-place overwrites
on conventional storage devices, but has experimental support for zoned block
devices.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>System Requirements</div><div class="admonitionContent_BuS1"><ul>
<li>Linux kernel: 6.15+ with CONFIG_XFS_FS and CONFIG_XFS_RT enabled</li>
<li>xfsprogs: 6.15+</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>First, check that your system meets the
<a href="/docs/filesystems/xfs#system-requirements">requirements</a>.</p>
<p>Formatting a zoned block device with <em>XFS</em> requires a separate randomly
writeable block device for metadata, unless the device has conventional zones
at the start of its address space.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="zoned-block-device-with-conventional-zones">Zoned Block Device with Conventional Zones<a href="#zoned-block-device-with-conventional-zones" class="hash-link" aria-label="Direct link to Zoned Block Device with Conventional Zones" title="Direct link to Zoned Block Device with Conventional Zones">​</a></h3>
<p>Formatting a zoned block device that has at least about 1% of its capacity
reported as conventional zones at the beginning of its address space does not
require a separate device for <em>XFS</em> metadata. This is the case for most SMR
hard-disks. For such device, <em>XFS</em> automatically and transparently splits the
device into different logical address spaces representing the main and realtime
devices. The main device is composed of the device conventional zones and
used to store <em>XFS</em> metadata. The realtime device is composed of the zoned
device sequential write required zones and used by default to store file data.</p>
<p>The following example formats an SMR hard-disk for use with <em>XFS</em> using the
command <code>mkfs.xfs</code>.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mkfs.xfs -f /dev/sda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meta-data=/dev/sda               isize=512    agcount=4, agsize=18317312 blks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       sectsz=4096  attr=2, projid32bit=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       crc=1        finobt=1, sparse=1, rmapbt=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       reflink=0    bigtime=1 inobtcount=1 nrext64=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       exchange=1   metadir=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data     =                       bsize=4096   blocks=73269248, imaxpct=25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       sunit=0      swidth=0 blks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log      =internal log           bsize=4096   blocks=35776, version=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       sectsz=4096  sunit=1 blks, lazy-count=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">realtime =internal               extsz=4096   blocks=7251034112, rtextents=7251034112</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       rgcount=110642 rgsize=65536 extents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       zoned=1      start=73269248 reserved=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resetting zones...Done.</span><br></span></code></pre></div></div>
<p>The formatted disk can now be mounted. No other setup is necessary.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mount /dev/sda /mnt</span><br></span></code></pre></div></div>
<p>The kernel messages will signal that <em>XFS</em> zoned device support is still
labelled as <em>experimental</em>.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">XFS (sda): EXPERIMENTAL zoned RT device feature enabled.  Use at your own risk!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XFS (sda): Mounting V5 Filesystem d2d4bc64-7bcb-4b25-bb05-22352a4ab4b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XFS (sda): Ending clean mount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XFS (sda): 110642 zones of 65536 blocks size (128 max open)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-zoned-block-devices">Other Zoned Block Devices<a href="#other-zoned-block-devices" class="hash-link" aria-label="Direct link to Other Zoned Block Devices" title="Direct link to Other Zoned Block Devices">​</a></h3>
<p>To format zoned block devices lacking conventional zones for use with <em>XFS</em>
(e.g. an NVMe Zoned Namespace SSD), a separate conventional block device must
be prepared to use as <em>XFS</em> main device (for storing metadata). Typically, the
main device capacity should be at least 1% of the total capacity of the zoned
block device. If the zoned block device used is an NVMe ZNS SSD, this separate
conventional block device can be a separate conventional namespace on the same
SSD.  Zoned block devices that have conventional zones can also be used only
for the realtime device. This is useful to combine an SSD for metadata with an
HDD for file data.</p>
<p>In this example, the (zoned) NVMe ZNS SSD /dev/nvme0n2 is used as the realtime
device and the conventional SSD /dev/nvme2n1 is used as the main device.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mkfs.xfs -r rtdev=/dev/nvme0n2 /dev/nvme2n1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meta-data=/dev/nvme2n1           isize=512    agcount=16, agsize=61047165 blks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       sectsz=512   attr=2, projid32bit=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       crc=1        finobt=1, sparse=1, rmapbt=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       reflink=0    bigtime=1 inobtcount=1 nrext64=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       exchange=1   metadir=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data     =                       bsize=4096   blocks=976754640, imaxpct=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       sunit=0      swidth=0 blks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log      =internal log           bsize=4096   blocks=476930, version=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">realtime =/dev/nvme0n2           extsz=4096   blocks=999180288, rtextents=999180288</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       rgcount=3624 rgsize=275712 extents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         =                       zoned=1      start=0 reserved=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Discarding blocks...Done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resetting zones...Done.</span><br></span></code></pre></div></div>
<p>Mounting the file system requires specifying both the main and realtime devices
with the mount command.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mount -o rtdev=/dev/nvme0n2 /dev/nvme2n1 /mnt</span><br></span></code></pre></div></div>
<p>The kernel messages will signal that <em>XFS</em> zoned device support is still
labelled as <em>experimental</em>.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">XFS (nvme2n1): EXPERIMENTAL zoned RT device feature enabled.  Use at your own risk!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XFS (nvme2n1): Mounting V5 Filesystem eb1fe112-bb66-4fec-9e6d-24cc2dfeb48e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XFS (nvme2n1): Ending clean mount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XFS (nvme2n1): 3624 zones of 275712 blocks size (14 max open)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning">Tuning<a href="#tuning" class="hash-link" aria-label="Direct link to Tuning" title="Direct link to Tuning">​</a></h3>
<p>By default, <em>XFS</em> uses the maximum number of open zones of the device minus one
as the limit for the maximum number of zones that can be simultaneously used to
write file data. For a mounted file system, this limit can be checked using the
<em>max_open_zones</em> configfs attribute.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/block/sda/queue/max_open_zones</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mkfs.xfs /dev/sda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mount /dev/sda /mnt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/fs/xfs/sda/zoned/max_open_zones</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">127</span><br></span></code></pre></div></div>
<p>Depending on the application workload and the zoned device used, reducing this
limit can improve write performance, albeit at the risk of increasing file
fragmentation, which can negatively impact read performance. Reducing the limit
on the maximum number of open realtime groups is done using the <em>max_open_zones</em>
mount option.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mount -o max_open_zones=32 /dev/sdb /mnt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/fs/xfs/sdb/zoned/max_open_zones</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">31</span><br></span></code></pre></div></div>
<p>The garbage collection threshold threshold can be configured in <em>sysfs</em> for
each file system using the <em>zonegc_low_space</em> attribute.</p>
<p>The default attribute value is 0, indicating that <em>XFS</em> tries to ensures that
there is at least one free zone available for each open zone, as long as there
is free space available.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mount /dev/sdb /mnt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/fs/xfs/sdb/zoned/zonegc_low_space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><br></span></code></pre></div></div>
<p>To more aggressively garbage-collect reclaimable zones, <em>zonegc_low_space</em> can
be increased. A value X indicates that <em>XFS</em> will attempt reclaiming zones to
have X percent of the unused storage space available for writing.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># echo 5 &gt; /sys/fs/xfs/sdb/zoned/zonegc_low_space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cat /sys/fs/xfs/sdb/zoned/zonegc_low_space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="placing-data-on-the-main-device">Placing Data on the Main Device<a href="#placing-data-on-the-main-device" class="hash-link" aria-label="Direct link to Placing Data on the Main Device" title="Direct link to Placing Data on the Main Device">​</a></h3>
<p>In <em>XFS</em>, the <em>realtime</em> attribute for files controls if they are placed on the
realtime device, and the <em>rtinherit</em> bit controls if files created inside a
directory and subdirectories of it are placed on the realtime device.</p>
<p>When using <em>XFS</em> on a zoned block devices, all file data is placed by default
on the realtime (zoned) device. That is, the <em>rtinherit</em> attribute on the file
system root directory is set by default. The <em>rtinherit</em> attribute can be
cleared for any directory and new files created in that hierarchy will be placed
on the main device. Similarly the <em>realtime</em> attribute can be cleared on a file
that does not have data allocated yet, and data allocated after that point will
be allocated on the main device.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mkdir /mnt/dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># xfs_io -c &#x27;lsattr&#x27; /mnt/dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------t--------X /mnt/dir</span><br></span></code></pre></div></div>
<p>A user can clear the <em>rtinherit</em> attribute for a file or a directory to store
a file data on the main device.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># xfs_io -c &#x27;chattr -t&#x27; /mnt/dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># xfs_io -c &#x27;lsattr&#x27; /mnt/dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------X /mnt/dir</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Typically space on the main device is very limited and intended for metadata.
So this option should be used with care to avoid filling up the main device
capacity as that would result in &quot;no space available&quot; (ENOSPC) errors even if
free space is available on the realtime device.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a href="#implementation" class="hash-link" aria-label="Direct link to Implementation" title="Direct link to Implementation">​</a></h2><p><em>XFS</em> zoned storage support is based on the <em>XFS</em> realtime device feature.
An <em>XFS</em> realtime device is a separate storage device managed by a separate
space allocator to store selective file data. <em>XFS</em> uses the realtime device to
manage zoned storage by replacing the realtime space allocator with a zoned
space allocator. With zoned devices, by default file data is stored on
the realtime device, while metadata is stored on the main device, which must
be randomly writeable.</p><p><em>XFS</em> metadata is space efficient thanks to the use of variable-length extents,
and thus <em>XFS</em> needs less than 1% conventional space for metadata. <em>XFS</em> uses
the no-overwrite support originally added to support reference-counted block
sharing (reflink) to support overwriting file data.</p><p><em>XFS</em> splits the storage address space into <em>allocation groups</em> for the main
device and <em>realtime groups</em> for the realtime device (the zoned block device).
<em>XFS</em> manages free space and the physical-to-logical reverse mapping locally in
each group to improve scalability.  With zoned block devices, each realtime
group always maps to exactly one hardware zone on the device.</p><p><em>XFS</em> tracks available free space using the persistent zone condition and zone
write pointer provided by the zoned device, and thus does not need any
persistent allocator metadata for the zoned realtime device.</p><p><em>XFS</em> always writes file data on zoned block devices using Zone Append
operations as that avoids serializing writes to a single zone.  For devices that
do not support Zone Append natively (e.g. SMR hard-disks), <em>XFS</em> relies on the
Linux block layer emulation (see <a href="/docs/linux/sched#zone-write-plugging">Zone Write
Plugging</a>).</p><p><em>XFS</em> can write to as many open groups (zones) as the hardware offers.</p><p>One open zone is always reserved for garbage collection, while all other open
zones are available for user file I/Os. To ensure that the number of open zones
stays under the hardware open zone limit, a new zone is only opened when all
writes to the previously open zone have completed.</p><p><em>XFS</em> zone allocator by default tries to avoid fragmenting files. If the files
being written to are still open, <em>XFS</em> attempts to separate the data for each
file into different zones. When starting to write to a file, a free zone is
chosen as the file data write location. If no free zone is available, or if the
number of open zones has reached the limit, the least recently used open zone is
used to write the file data. If the file has already been closed by the time of
writeback (buffered I/O case), file data are co-located to pack multiple files
tightly to improve read performance.</p><p>To reduce garbage collection overhead, the zone allocator aims to fill zones
with data of similar lifetime. The allocator assumes that all data in a file
have similar lifetime. The per-file <em>F_SET_RW_HINT</em> file control system call
(<em>fcntl</em>) interface allows applications to indicate if data is short, medium,
long, or extremely long lived to the kernel. <em>XFS</em> uses these lifetime hints to
guide zone selection: file data from different files marked as having the same
lifetime are co-located in zones marked with the same lifetime.</p><p><em>XFS</em> always immediately resets zones that do not contain valid blocks, but
otherwise does not perform background garbage collection. Instead, the garbage
collection thread (<em>GCD</em>) is woken up when the number of free zones drops below
the configurable threshold. Writers that get ahead of <em>GCD</em> are put to sleep
until <em>GCD</em> recovers enough free zones.</p><p><em>GCD</em> implements a greedy garbage collection policy and selects the reclaimable
zone with the least number of valid blocks. <em>GCD</em> does not hold locks over I/O,
and thus garbage collection does not directly interfere with applications
accessing files that <em>GCD</em> operates on.</p><p><em>GCD</em> uses a dedicated open zone, so that garbage-collected data is not mixed
with file data being written. Using a dedicated open zone for garbage collection
reduces write amplification as garbage collected data can be assumed to be
longer-lived than incoming user data. Adequate free space is set aside for <em>GCD</em>
so that it is never blocked by user writes and can provide a free zone to user
writers as long as the file system reports free blocks.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="limitations">Limitations<a href="#limitations" class="hash-link" aria-label="Direct link to Limitations" title="Direct link to Limitations">​</a></h2><p>Because zoned devices do not allow in-place updates, persistent preallocations
can fundamentally not be supported with a zoned block device.</p><p>Additionally, disk quotas and reference-counted block sharing (reflink) are
currently not supported (that is expected to change in the near future).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-requirements">System Requirements<a href="#system-requirements" class="hash-link" aria-label="Direct link to System Requirements" title="Direct link to System Requirements">​</a></h2><p><em>XFS</em> native zoned block device support was introduced with kernel version 6.15.
The kernel must be compiled with <em>XFS</em> support (the kernel configuration
parameter CONFIG_XFS_FS must be enabled). <em>XFS</em> realtime device feature is also
required (the kernel configuration parameter CONFIG_XFS_RT must be enabled).</p><p>Installing version 6.15 or higher of the <em>xfsprogs</em> package providing <em>XFS</em>
user space tools (e.g. <code>mkfs.xfs</code>) is also required.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># mkfs.xfs -V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.xfs version 6.15.0</span><br></span></code></pre></div></div><p>If your Linux distribution does not provides an adequate version of <em>xfsprogs</em>,
this project source code can be downloaded from <a href="https://git.kernel.org/pub/scm/fs/xfs/xfsprogs-dev.git" target="_blank">
kernel.org</a>. See the <a href="https://git.kernel.org/pub/scm/fs/xfs/xfsprogs-dev.git/tree/doc/INSTALL" target="_blank">INSTALL</a> file for instructions on how to compile and install
this package.</p></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/filesystems"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/filesystems/btrfs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">BTRFS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#zoned-block-device-with-conventional-zones" class="table-of-contents__link toc-highlight">Zoned Block Device with Conventional Zones</a></li><li><a href="#other-zoned-block-devices" class="table-of-contents__link toc-highlight">Other Zoned Block Devices</a></li><li><a href="#tuning" class="table-of-contents__link toc-highlight">Tuning</a></li><li><a href="#placing-data-on-the-main-device" class="table-of-contents__link toc-highlight">Placing Data on the Main Device</a></li></ul></li><li><a href="#implementation" class="table-of-contents__link toc-highlight">Implementation</a></li><li><a href="#limitations" class="table-of-contents__link toc-highlight">Limitations</a></li><li><a href="#system-requirements" class="table-of-contents__link toc-highlight">System Requirements</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started with Zoned Storage</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
</body>
</html>