<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tests/zbc-tests" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">ZBC/ZAC Compliance Tests | Zoned Storage</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zonedstorage.io/docs/tests/zbc-tests"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ZBC/ZAC Compliance Tests | Zoned Storage"><meta data-rh="true" name="description" content="Developers may face many problems with an application development if the system"><meta data-rh="true" property="og:description" content="Developers may face many problems with an application development if the system"><link data-rh="true" rel="icon" href="/img/zs-logo.ico"><link data-rh="true" rel="canonical" href="https://zonedstorage.io/docs/tests/zbc-tests"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/tests/zbc-tests" hreflang="en"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/tests/zbc-tests" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><link rel="stylesheet" href="/assets/css/styles.5cd6be9b.css">
<script src="/assets/js/runtime~main.a299f646.js" defer="defer"></script>
<script src="/assets/js/main.5c9ead0e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Zoned Storage</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/introduction">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/getting-started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/filesystems">File Systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/applications">Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tools">Tools and Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/linux">Linux Kernel Support</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/tests">System Compliance Tests</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tests">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tests/zbc-tests">ZBC/ZAC Compliance Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tests/blktests">Kernel Block Layer Tests</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/benchmarking">Performance Benchmarking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/distributions/overview">Linux Distributions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">System Compliance Tests</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ZBC/ZAC Compliance Tests</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ZBC/ZAC Compliance Tests</h1>
<p>Developers may face many problems with an application development if the system
being used has non-compliant components, either software or hardware.</p>
<p>The typical problems that can be faced may be due to a SAS HBA not fully
compatible with the ZBC and ZAC standards (e.g. The HBA has a defective
translation layer implementation) or the kernel version includes a bug resulting
for instance in write commands not being translated correctly or an invalid
command failure processing.</p>
<p>Many of these problems can be identified early by executing
<a href="/docs/tools/libzbc"><em>libzbc</em></a> conformance test suite.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="libzbc-conformance-test-suite"><em>libzbc</em> Conformance Test Suite<a href="#libzbc-conformance-test-suite" class="hash-link" aria-label="Direct link to libzbc-conformance-test-suite" title="Direct link to libzbc-conformance-test-suite">​</a></h2>
<p><em>libzbc</em> implements a test suite primarily aiming at checking that a disk
fully conforms to the definition and constraints of the ZAC and ZBC standards.
<em>libzbc</em> test suite works equally well with physical disks (SAS and SATA) as
well as emulated disks created with <a href="/docs/tools/tcmu-runner"><em>tcmu-runner</em></a>.</p>
<p>Information on how to compile and install <em>libzbc</em> with the test suite
enabled can be found <a href="/docs/tools/libzbc">here</a>.</p>
<p>In this chapter, the following disk configuration is used throughout the
examples shown.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># lsscsi -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2:0:0:0]    disk    ATA      INTEL SSDSC2CT18 335u  /dev/sda   /dev/sg0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5:0:0:0]    zbc     ATA      HGST HSH721415AL T220  /dev/sdb   /dev/sg1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:0:2:0]   zbc     HGST     HSH721414AL52M0  a220  /dev/sdc   /dev/sg2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:0:3:0]   zbc     ATA      HGST HSH721415AL T220  /dev/sdd   /dev/sg3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>/dev/sdb</em> is a SATA disk connected to an AHCI controller (SATA port),
<em>/dev/sdc</em> is a SAS disk connected to a SAS HBA and <em>/dev/sdc</em> is a SATA disk
connected to the same SAS HBA.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="checking-serial-ata-disks">Checking Serial ATA Disks<a href="#checking-serial-ata-disks" class="hash-link" aria-label="Direct link to Checking Serial ATA Disks" title="Direct link to Checking Serial ATA Disks">​</a></h2>
<p>To check a SATA ZAC disk correct operation and conformance to the ZAC standard,
<em>libzbc</em> test suite must be executed using the &quot;--ata&quot; option.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p><em>libzbc</em> test suite must be executed against the disk SCSI generic node file
(e.g. <em>/dev/sg</em> path) to enable the full range of direct SCSI or ATA command
execution without any interference from the kernel block I/O stack. <em>libzbc</em>
test suite will not run if the disk block device file (<em>/dev/sd</em>) is
specified.</p></div></div>
<p>Using the AHCI connected SATA disk <em>/dev/sdb</em>, which corresponds to the SCSI
generic node file <em>/dev/sg1</em>, the execution of the 107 test cases of <em>libzbc</em>
test suite result in the following output.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cd libzbc/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ./zbc_test.sh --ata /dev/sg1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 00 - command completion tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.010: REPORT_ZONES command completion...                                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.011: REPORT_ZONES (partial bit) command completion...                              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.012: REPORT_ZONES (reporting option 0x10) command completion...                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.013: REPORT_ZONES (reporting option 0x11) command completion...                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.014: REPORT_ZONES (reporting option 0x3F) command completion...                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.020: OPEN_ZONE command completion...                                               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.030: CLOSE_ZONE command completion...                                              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.040: FINISH_ZONE command completion...                                             [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.050: RESET_WRITE_PTR command completion...                                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.060: WRITE command completion...                                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.070: READ command completion...                                                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 01 - sense key, sense code tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.010: REPORT_ZONES logical block out of range...                                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.011: REPORT_ZONES invalid reporting option...                                      [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.020: OPEN_ZONE invalid zone start lba...                                           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.021: OPEN_ZONE insufficient zone resources...                                      [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.022: OPEN_ZONE insufficient zone resources (ALL bit set)...                        [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.023: OPEN_ZONE conventional zone...                                                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.024: OPEN zone LBA at End of Medium...                                             [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.030: CLOSE_ZONE invalid zone start lba...                                          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.031: CLOSE_ZONE conventional zone...                                               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.032: CLOSE zone LBA at End of Medium...                                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.040: FINISH_ZONE invalid zone start lba...                                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.041: FINISH_ZONE conventional zone...                                              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.042: FINISH zone LBA at End of Medium...                                           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.050: RESET_WRITE_PTR invalid zone start lba...                                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.051: RESET_WRITE_PTR conventional zone...                                          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.052: RESET zone LBA at End of Medium...                                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.060: READ access sequential zone LBAs after write pointer...                       [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.061: READ sequential zones boundary violation...                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.062: READ conventional/sequential zones boundary violation...                      [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.063: READ across write-pointer zones (FULL-&gt;FULL)...                               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.064: READ access write pointer zone LBAs starting after write pointer...           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.070: WRITE unaligned write in sequential zone...                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.071: WRITE sequential zone boundary violation...                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.072: WRITE insufficient zone resources...                                          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.073: WRITE full zone...                                                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.074: WRITE physical sector unaligned write to sequential zone...                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.075: WRITE unaligned ending below write pointer...                                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.076: WRITE unaligned crossing write pointer...                                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.077: WRITE across zone-type spaces (cross-type boundary violation)...              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.080: READ cross-zone FULL-&gt;IOPENL and ending above Write Pointer...                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.081: READ cross-zone FULL-&gt;IOPENL and ending below Write Pointer...                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.082: READ cross-zone IOPENH-&gt;FULL starting below Write Pointer...                  [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.083: READ cross-zone IOPENL-&gt;FULL starting above Write Pointer...                  [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.090: WRITE cross-zone FULL-&gt;IOPENL and ending above Write Pointer...               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.091: WRITE cross-zone FULL-&gt;IOPENL and ending below Write Pointer...               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.092: WRITE cross-zone IOPENH-&gt;FULL starting below Write Pointer...                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.093: WRITE cross-zone IOPENL-&gt;FULL starting above Write Pointer...                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.094: WRITE cross-zone FULL-&gt;EMPTY...                                               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.095: WRITE cross-zone EMPTY-&gt;EMPTY starting above Write Pointer...                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 02 - zone state machine tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.001: OPEN_ZONE empty to explicit open...                                           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.002: CLOSE_ZONE empty to empty...                                                  [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.003: FINISH_ZONE empty to full...                                                  [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.004: RESET_WRITE_PTR empty to empty...                                             [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.005: OPEN_ZONE implicit open to explicit open...                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.006: CLOSE_ZONE implicit open to closed...                                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.007: FINISH_ZONE implicit open to full...                                          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.008: RESET_WRITE_PTR implicit open to empty...                                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.009: OPEN_ZONE empty to explicit open to explicit open...                          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.010: CLOSE_ZONE empty to explicit open to empty...                                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.011: FINISH_ZONE empty to explicit open to full...                                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.012: RESET_WRITE_PTR empty to explicit open to empty...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.013: OPEN_ZONE implicit open to explicit open to explicit open...                  [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.014: CLOSE_ZONE implicit open to explicit open to closed...                        [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.015: FINISH_ZONE implicit open to explicit open to full...                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.016: RESET_WRITE_PTR implicit open to explicit open to empty...                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.017: OPEN_ZONE closed to explicit open...                                          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.018: CLOSE_ZONE closed to closed...                                                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.019: FINISH_ZONE closed to full...                                                 [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.020: RESET_WRITE_PTR closed to empty...                                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.021: OPEN_ZONE full to full...                                                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.022: CLOSE_ZONE full to full...                                                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.023: FINISH_ZONE full to full...                                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.024: RESET_WRITE_PTR full to empty...                                              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.025: OPEN_ZONE empty to empty (ALL bit set)...                                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.026: CLOSE_ZONE empty to empty (ALL bit set)...                                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.027: FINISH_ZONE empty to empty (ALL bit set)...                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.028: RESET_WRITE_PTR empty to empty (ALL bit set)...                               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.029: OPEN_ZONE implicit open to implicit open (ALL bit set)...                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.030: CLOSE_ZONE implicit open to close (ALL bit set)...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.031: FINISH_ZONE implicit open to full (ALL bit set)...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.032: RESET_WRITE_PTR implicit open to empty (ALL bit set)...                       [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.033: OPEN_ZONE empty to explicit open to explicit open (ALL bit set)...            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.034: CLOSE_ZONE empty to explicit open to empty (ALL bit set)...                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.035: FINISH_ZONE empty to explicit open to full (ALL bit set)...                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.036: RESET_WRITE_PTR empty to explicit open to empty (ALL bit set)...              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.037: OPEN_ZONE implicit open to explicit open to explicit_open (ALL bit set)...    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.038: CLOSE_ZONE implicit open to explicit open to closed (ALL bit set)...          [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.039: FINISH_ZONE implicit open to explicit open to full (ALL bit set)...           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.040: RESET_WRITE_PTR implicit open to explicit open to empty (ALL bit set)...      [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.041: OPEN_ZONE closed to explicit open (ALL bit set)...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.042: CLOSE_ZONE closed to closed (ALL bit set)...                                  [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.043: FINISH_ZONE closed to full (ALL bit set)...                                   [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.044: RESET_WRITE_PTR closed to empty test (ALL bit set)...                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.045: OPEN_ZONE full to full (ALL bit set)...                                       [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.046: CLOSE_ZONE full to full (ALL bit set)...                                      [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.047: FINISH_ZONE full to full (ALL bit set)...                                     [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.048: RESET_WRITE_PTR full to empty (ALL bit set)...                                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.070: WRITE empty to implicit open...                                               [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.071: WRITE empty to full...                                                        [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.072: WRITE implicit open to implicit open...                                       [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.073: WRITE implicit open to full...                                                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.074: WRITE closed to implicit open...                                              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.075: WRITE closed to full...                                                       [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.076: WRITE explicit open to explicit open...                                       [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.077: WRITE explicit open to full...                                                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.078: WRITE full to full...                                                         [Passed]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The same execution procedure can be applied to the SATA disk <em>/dev/sdd</em>
connected to the SAS HBA. This disk has the SCSI generic node file <em>/dev/sg3</em>.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cd libzbc/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ./zbc_test.sh --ata /dev/sg3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 00 - command completion tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.010: REPORT_ZONES command completion...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.011: REPORT_ZONES (partial bit) command completion...              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.012: REPORT_ZONES (reporting option 0x10) command completion...    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.070: READ command completion...                                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 01 - sense key, sense code tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.010: REPORT_ZONES logical block out of range...                    [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.095: WRITE cross-zone EMPTY-&gt;EMPTY starting above Write Pointer... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 02 - zone state machine tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.001: OPEN_ZONE empty to explicit open...                           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.077: WRITE explicit open to full...                                [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.078: WRITE full to full...                                         [Passed]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If a test case fails, an error message similar to the example below is shown
and the test suite stops execution.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cd libzbc/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ./zbc_test.sh --ata XXX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 00 - command completion tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.010: REPORT_ZONES command completion...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.011: REPORT_ZONES (partial bit) command completion...              [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01.095: WRITE cross-zone EMPTY-&gt;EMPTY starting above Write Pointer... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 02 - zone state machine tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.078: WRITE full to full...                                         [Failed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    =&gt; Expected Illegal-request / Invalid-field-in-cdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       Got Illegal-request / Unaligned-write-command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A test case failure is a strong indicator that the disk may not be fully
compliant with the ZAC specifications. Most failures can generally be confirmed
using a bus analyzer to obtain a command trace for the failing test sequence.
Other root cause for any test failure are always a possibility.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="checking-sas-disks">Checking SAS Disks<a href="#checking-sas-disks" class="hash-link" aria-label="Direct link to Checking SAS Disks" title="Direct link to Checking SAS Disks">​</a></h2>
<p>Testing physical SAS disks as well as <em>tcmu-runner</em> emulated SCSI disks do not
require the <em>--ata</em> option. Using the SAS disk <em>/dev/sg2</em>, the test suite output
is the same as with SATA disks if all tests pass.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cd libzbc/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ./zbc_test.sh /dev/sg2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 00 - command completion tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.010: REPORT_ZONES command completion...                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.011: REPORT_ZONES (partial bit) command completion...           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.012: REPORT_ZONES (reporting option 0x10) command completion... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.013: REPORT_ZONES (reporting option 0x11) command completion... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.014: REPORT_ZONES (reporting option 0x3F) command completion... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.020: OPEN_ZONE command completion...                            [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.077: WRITE explicit open to full...                             [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.078: WRITE full to full...                                      [Passed]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-kernel-scsi-to-ata-translation-layer">Checking the Kernel SCSI-To-ATA Translation Layer<a href="#checking-the-kernel-scsi-to-ata-translation-layer" class="hash-link" aria-label="Direct link to Checking the Kernel SCSI-To-ATA Translation Layer" title="Direct link to Checking the Kernel SCSI-To-ATA Translation Layer">​</a></h2>
<p>When <em>libzbc</em> test suite is executed with the &quot;--ata&quot; option, ATA commands are
sent directly to the disk using the SCSI generic driver passthrough facility.
These ATA commands are directly embedded into the ATA16 SCSI passthrough
command, allowing to completely bypass the kernel SCSI to ATA translation layer
implemented by the kernel <em>libata</em> component.</p>
<p>Executing <em>libzbc</em> test suite against a SATA disk connected to a SATA port (e.g.
An AHCI adapter port) will result in the test suite issuing only SCSI commands
that will be translated by the kernel <em>libata</em> before sending as ATA commands to
the disk. That is, the kernel SAT can be exercised.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cd libzbc/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ./zbc_test.sh /dev/sg1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 00 - command completion tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.010: REPORT_ZONES command completion...                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.011: REPORT_ZONES (partial bit) command completion...           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.012: REPORT_ZONES (reporting option 0x10) command completion... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.077: WRITE explicit open to full...                             [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.078: WRITE full to full...                                      [Passed]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If all tests pass, then the kernel SAT layer can be considered as correct. On
the other hand, if some tests fails while all tests pass with the <em>--ata</em> option
used, then the kernel SAT implementation becomes a candidate as the root cause
for the failure. This analysis is summarized in the table below.</p>
<div class="container text--center"><figure><img src="/assets/images/tests-zbc-kernel-166564aae2e5ad8dc156175fbf8f2e85.png" width="640" max-width="100%"><figcaption><em>Probable failure root cause with SATA disks on AHCI ports</em></figcaption></figure></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="checking-the-hba-scsi-to-ata-translation-layer">Checking the HBA SCSI-TO-ATA Translation Layer<a href="#checking-the-hba-scsi-to-ata-translation-layer" class="hash-link" aria-label="Direct link to Checking the HBA SCSI-TO-ATA Translation Layer" title="Direct link to Checking the HBA SCSI-TO-ATA Translation Layer">​</a></h2>
<p>Similarly to the previous case, executing <em>libzbc</em> test suite without the
<em>--ata</em> option against a SATA disk connected to a SAS HBA will exercise the HBA
SCSI to ATA command translation by removing the use of the ATA16 passthrough
command.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cd libzbc/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ./zbc_test.sh /dev/sg3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing section 00 - command completion tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.010: REPORT_ZONES command completion...                         [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.011: REPORT_ZONES (partial bit) command completion...           [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    00.012: REPORT_ZONES (reporting option 0x10) command completion... [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.077: WRITE explicit open to full...                             [Passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02.078: WRITE full to full...                                      [Passed]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Again comparing the result of the test suite execution for the two cases (with
and without the &quot;--ata&quot; option) gives hints on the root cause of eventual test
failures. The table below indicates the possible failure root cause when the
test suite reports errors.</p>
<div class="container text--center"><figure><img src="/assets/images/tests-zbc-hba-4a57d56fc6c4d400eadc1692b1907a27.png" width="640" max-width="100%"><figcaption><em>Probable failure root cause with SATA disks on SAS HBA</em></figcaption></figure></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tests"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tests/blktests"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Kernel Block Layer Tests</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#libzbc-conformance-test-suite" class="table-of-contents__link toc-highlight"><em>libzbc</em> Conformance Test Suite</a></li><li><a href="#checking-serial-ata-disks" class="table-of-contents__link toc-highlight">Checking Serial ATA Disks</a></li><li><a href="#checking-sas-disks" class="table-of-contents__link toc-highlight">Checking SAS Disks</a></li><li><a href="#checking-the-kernel-scsi-to-ata-translation-layer" class="table-of-contents__link toc-highlight">Checking the Kernel SCSI-To-ATA Translation Layer</a></li><li><a href="#checking-the-hba-scsi-to-ata-translation-layer" class="table-of-contents__link toc-highlight">Checking the HBA SCSI-TO-ATA Translation Layer</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started with Zoned Storage</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/zonedstorage/shared_invite/zt-uyfut5xe-nKajp9YRnEWqiD4X6RkTFw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://webchat.oftc.net/?channels=zonedstorage" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC @ OFTC<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
</body>
</html>