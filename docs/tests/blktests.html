<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tests/blktests" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Kernel Block Layer Tests | Zoned Storage</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zonedstorage.io/docs/tests/blktests"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kernel Block Layer Tests | Zoned Storage"><meta data-rh="true" name="description" content="blktests is a test suite for Linux kernel storage stack, that is, the"><meta data-rh="true" property="og:description" content="blktests is a test suite for Linux kernel storage stack, that is, the"><link data-rh="true" rel="icon" href="/img/zs-logo.ico"><link data-rh="true" rel="canonical" href="https://zonedstorage.io/docs/tests/blktests"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/tests/blktests" hreflang="en"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/tests/blktests" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Kernel Block Layer Tests","item":"https://zonedstorage.io/docs/tests/blktests"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><link rel="stylesheet" href="/assets/css/styles.0fff285b.css">
<script src="/assets/js/runtime~main.92571c25.js" defer="defer"></script>
<script src="/assets/js/main.69b7e4e5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Zoned Storage</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/introduction">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/getting-started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/linux">Linux Kernel Support</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/device-mapper">Device Mapper</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/filesystems">File Systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/applications">Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tools">Tools and Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/tests">System Compliance Tests</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tests">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tests/zbc-tests">ZBC/ZAC Compliance Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tests/blktests">Kernel Block Layer Tests</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/benchmarking">Performance Benchmarking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/distributions/overview">Linux Distributions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">System Compliance Tests</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Kernel Block Layer Tests</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Kernel Block Layer Tests</h1></header>
<p><em>blktests</em> is a test suite for Linux kernel storage stack, that is, the
block I/O layer as well as underlying device specific layers (SCSI, NVMe, SRP,
etc). <em>blktests</em> is heavily inspired by the <em>xfstests</em> framework for testing
file systems.</p>
<p>Recent contributions to <em>blktests</em> added zoned block device tests support.</p>
<p>The <em>blktests</em> project is hosted on
<a href="https://github.com/linux-blktests/blktests" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p><em>blktests</em> organizes test cases into groups. The test groups currently available
are as shown in the table below.</p>
<center><table><thead><tr><th style="text-align:left">Group name</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left"><strong>block</strong></td><td style="text-align:left">Block layer generic tests</td></tr><tr><td style="text-align:left"><strong>loop</strong></td><td style="text-align:left">Loopback device tests</td></tr><tr><td style="text-align:left"><strong>meta</strong></td><td style="text-align:left"><em>blktests</em> self tests</td></tr><tr><td style="text-align:left"><strong>nbd</strong></td><td style="text-align:left">Network block device driver tests</td></tr><tr><td style="text-align:left"><strong>nvme</strong></td><td style="text-align:left">NVMe driver tests</td></tr><tr><td style="text-align:left"><strong>nvmeof-mp</strong></td><td style="text-align:left">NVME-over-fabrics multipath tests</td></tr><tr><td style="text-align:left"><strong>scsi</strong></td><td style="text-align:left">SCSI layer tests</td></tr><tr><td style="text-align:left"><strong>srp</strong></td><td style="text-align:left">SCSI RDMA Protocol driver tests</td></tr><tr><td style="text-align:left"><strong>zbd</strong></td><td style="text-align:left">Zoned block device tests</td></tr></tbody></table></center>
<p>The test groups supporting zoned block devices are <em>block</em> and <em>zbd</em>.
<a href="/docs/tools/util-linux#blkzone"><em>blkzone</em></a> and <a href="/docs/benchmarking/fio/overview"><em>fio</em></a>
version 3.9 or higher must be installed for executing these test groups.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>Detailed generic information on how to configure and run <em>blktests</em> is
provided <a href="https://github.com/osandov/blktests/blob/master/Documentation/running-tests.md" target="_blank">here</a>.</p>
<p>For executing tests against a physical zoned block device (e.g. a ZBC/ZAC disk),
the following <code>config</code> file should be prepared and copied to the <em>blktests</em>
installation directory. Tests can also be executed directly from the source
directory if the <code>config</code> file is copied in that location.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Tests target device list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEST_DEVS=(/dev/sdd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable zoned block device mode for the block group genertic tests </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN_ZONED_TESTS=1</span><br></span></code></pre></div></div>
<p>With this configuration, all tests relevant to zoned block devices will be
executed. The execution duration can be several 10s of minutes depending on the
target device and host system. To Shorten execution, the options <code>TIMEOUT</code> and
<code>QUICK_RUN</code> can be added to the configuration.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Tests target device list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEST_DEVS=(/dev/sdd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable zoned block device mode for the block group genertic tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN_ZONED_TESTS=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Speed up execution (weaker tests)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUICK_RUN=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TIMEOUT=30</span><br></span></code></pre></div></div>
<p>Of note is that the block layer generic tests of the <em>block</em> group also include
test cases executed against a logical device (<em>null_blk</em> block device). These
tests are executed twice, once with the <em>null_blk</em> device configured as a
regular block device and a second time with the <em>null_blk</em> device configured as
a zoned block device. To reduce the test cases execution to only the physical
device specified in the configuration file, the <code>DEVICE_ONLY</code> option can be set.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Tests target device list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEST_DEVS=(/dev/sdd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable zoned block device mode for the block group genertic tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN_ZONED_TESTS=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Speed up execution (weaker tests)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUICK_RUN=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TIMEOUT=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Exercise only the devices in TEST_DEVS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEVICE_ONLY=1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execution">Execution<a href="#execution" class="hash-link" aria-label="Direct link to Execution" title="Direct link to Execution">​</a></h2>
<p><em>blktests</em> execution is done using the <code>check</code> script present in the top level
directory. This script optionally takes as argument a list of test groups or
test cases to execute. Bu default, without any argument, all test groups will be
executed.</p>
<p>For zoned block device tests, executing the test cases of the <em>block</em> and <em>zbd</em>
test groups is sufficient.</p>
<p>As discussed in the <a href="#configuration">configuration</a> section above, several
options can speedup the execution of <em>blktests</em>. Such quick runs are indeed
faster but at the cost of weaker testing compared to full runs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-run">Full Run<a href="#full-run" class="hash-link" aria-label="Direct link to Full Run" title="Direct link to Full Run">​</a></h3>
<p>The following command executes all test cases relevant to zoned block devices
with the device specified in the <code>config</code> configuration file as target. In this
example, no options are added.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ./check block zbd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/001 (stress device hotplugging)                        [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  120.013s  ...  123.440s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/002 (remove a device while running blktrace)           [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.741s  ...  0.761s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/003 =&gt; sdd (run various discard sizes)                 [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/004 =&gt; sdd (run lots of flushes)                       [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime     98.876s  ...  82.665s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write iops  170      ...  203</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/005 =&gt; sdd (switch schedulers while doing IO)          [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    read iops  1415    ...  791</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    6.765s  ...  11.242s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/006 (run null-blk in blocking mode)                    [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    read iops  154220   ...  152356</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    19.158s  ...  19.229s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/006 (zoned) (run null-blk in blocking mode)            [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    read iops  150692   ...  146826</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    19.128s  ...  19.720s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/007 =&gt; sdd (test classic and hybrid IO polling)        [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/008 (do IO while hotplugging CPUs)                     [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CPU hotplugging is not supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/009 (check page-cache coherency after BLKDISCARD)      [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.827s  ...  0.868s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/010 (run I/O on null_blk with shared and non-shared tags) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Individual tags read iops  254661    ...  253371</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Shared tags read iops      174876    ...  174933</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime                    695.714s  ...  715.579s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/010 (zoned) (run I/O on null_blk with shared and non-shared tags) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Individual tags read iops  253356    ...  252487</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Shared tags read iops      174871    ...  174780</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime                    667.479s  ...  652.577s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/011 =&gt; sdd (disable PCI device while doing I/O)        [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.293s  ...  17.760s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/012 =&gt; sdd (check that a read-only block device fails writes) [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/013 =&gt; sdd (try BLKRRPART on a mounted device)         [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/014 (run null-blk with blk-mq and timeout injection configured) [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    null_blk module does not have parameter timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/015 (run null-blk on different schedulers with requeue injection configured) [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    null_blk module does not have parameter requeue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/016 (send a signal to a process waiting on a frozen queue) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.055s  ...  8.055s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/016 (zoned) (send a signal to a process waiting on a frozen queue) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.055s  ...  8.055s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/017 (do I/O and check the inflight counter)            [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.691s  ...  1.675s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/017 (zoned) (do I/O and check the inflight counter)    [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.690s  ...  1.692s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/018 (do I/O and check iostats times)                   [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  5.075s  ...  5.077s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/019 =&gt; sdd (break PCI link device while doing I/O)     [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/020 (run null-blk on different schedulers with only one hardware tag) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  43.139s  ...  43.191s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/020 (zoned) (run null-blk on different schedulers with only one hardware tag) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  43.120s  ...  43.206s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/021 (read/write nr_requests on null-blk with different schedulers) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.396s  ...  1.393s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/021 (zoned) (read/write nr_requests on null-blk with different schedulers) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.399s  ...  1.419s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/023 (do I/O on all null_blk queue modes)               [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.276s  ...  0.280s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/023 (zoned) (do I/O on all null_blk queue modes)       [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  0.279s  ...  0.302s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/024 (do I/O faster than a jiffy and check iostats times) [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  4.902s  ...  4.904s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/025 (do a huge discard with 4k sector size)            [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  8.869s  ...  8.921s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/027 (stress device hotplugging with running fio jobs and different schedulers) [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    no support for io cgroup controller; if it is enabled, you may need to boot with cgroup_no_v1=io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/028 (do I/O on scsi_debug with DIF/DIX enabled)        [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  19.924s  ...  19.942s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/001 =&gt; sdd (sysfs and ioctl)                             [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  0.706s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/002 =&gt; sdd (report zone)                                 [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  6.534s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/003 =&gt; sdd (reset sequential required zones)             [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  13.324s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/004 =&gt; sdd (write split across sequential zones)         [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  17.019s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/005 =&gt; sdd (write command ordering)                      [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime       ...  178.335s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write io      ...  7196672</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write iops    ...  933</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/006 =&gt; sdd (revalidate)                                  [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime       ...  61.028s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write io      ...  1805004</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write iops    ...  15041</span><br></span></code></pre></div></div>
<p>The output of some tests is <em>[not run]</em>. This is not a failure. This only
indicates that the target device specified in the configuration file does not
support the feature being tested. For example, in the above run, test case
<em>block/003</em> is not executed against the specified host managed disk because the
disk does not support the <em>discard</em> command.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="quick-run">Quick Run<a href="#quick-run" class="hash-link" aria-label="Direct link to Quick Run" title="Direct link to Quick Run">​</a></h3>
<p><em>blkltests</em> execution can be accelerated using the <code>TIMEOUT</code>, <code>QUICK_RUN</code> and
<code>DEVICE_ONLY</code> configuration options.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Tests target device list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEST_DEVS=(/dev/sdd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable zoned block device mode for the block group genertic tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN_ZONED_TESTS=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Speed up execution (weaker tests)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUICK_RUN=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TIMEOUT=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Exercise only the devices in TEST_DEVS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEVICE_ONLY=1</span><br></span></code></pre></div></div>
<p>Running only the <em>block</em> and <em>zbd</em> test groups with the above configuration
gives the following results.</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ./check block zbd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/003 =&gt; sdd (run various discard sizes)                 [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/004 =&gt; sdd (run lots of flushes)                       [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime     913.097s  ...  33.714s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write iops            ...  239</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/005 =&gt; sdd (switch schedulers while doing IO)          [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    read iops  2975     ...  3573</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    22.510s  ...  19.194s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/007 =&gt; sdd (test classic and hybrid IO polling)        [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/008 =&gt; sdd (do IO while hotplugging CPUs)              [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/011 =&gt; sdd (disable PCI device while doing I/O)        [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime    ...  30.322s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/012 =&gt; sdd (check that a read-only block device fails writes) [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/013 =&gt; sdd (try BLKRRPART on a mounted device)         [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block/019 =&gt; sdd (break PCI link device while doing I/O)     [not run]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /dev/sdd is a zoned block device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/001 =&gt; sdd (sysfs and ioctl)                             [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  1.328s  ...  0.521s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/003 =&gt; sdd (reset sequential required zones)             [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  9.591s  ...  11.008s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/004 =&gt; sdd (write split across sequential zones)         [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime  11.772s  ...  11.743s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/005 =&gt; sdd (write command ordering)                      [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime     59.688s  ...  167.521s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write io    7201536  ...  7113472</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write iops  933      ...  921</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zbd/006 =&gt; sdd (revalidate)                                  [passed]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime     7.063s  ...  39.464s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write io            ...  2097152</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    write iops          ...  48971</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tests/zbc-tests"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ZBC/ZAC Compliance Tests</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/benchmarking"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#execution" class="table-of-contents__link toc-highlight">Execution</a><ul><li><a href="#full-run" class="table-of-contents__link toc-highlight">Full Run</a></li><li><a href="#quick-run" class="table-of-contents__link toc-highlight">Quick Run</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started with Zoned Storage</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
</body>
</html>