<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-linux/config" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Kernel Configuration | Zoned Storage</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://zonedstorage.io/docs/linux/config"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kernel Configuration | Zoned Storage"><meta data-rh="true" name="description" content="Several kernel compilation configuration options control zoned block device"><meta data-rh="true" property="og:description" content="Several kernel compilation configuration options control zoned block device"><link data-rh="true" rel="icon" href="/img/zs-logo.ico"><link data-rh="true" rel="canonical" href="https://zonedstorage.io/docs/linux/config"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/linux/config" hreflang="en"><link data-rh="true" rel="alternate" href="https://zonedstorage.io/docs/linux/config" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Kernel Configuration","item":"https://zonedstorage.io/docs/linux/config"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0DX1KGD5E4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0DX1KGD5E4",{})</script><link rel="stylesheet" href="/assets/css/styles.0fff285b.css">
<script src="/assets/js/runtime~main.28008f1b.js" defer="defer"></script>
<script src="/assets/js/main.69b7e4e5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/zs-logo.png" alt="Zoned Storage Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Zoned Storage</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/docs/community/support">Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/westerndigitalcorporation/zonedstorage.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/introduction">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/getting-started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/linux">Linux Kernel Support</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/overview">Linux Kernel Zoned Storage Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/linux/config">Kernel Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/zbd-api">Zoned Block Device User Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/sched">Write Ordering Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/part">Zoned Block Device Partition Support</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/device-mapper">Device Mapper</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/filesystems">File Systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/applications">Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tools">Tools and Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tests">System Compliance Tests</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/benchmarking">Performance Benchmarking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/distributions/overview">Linux Distributions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">Frequently Asked Questions</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Linux Kernel Support</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Kernel Configuration</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Kernel Configuration</h1></header>
<p>Several kernel compilation configuration options control zoned block device
support features.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="block-layer">Block Layer<a href="#block-layer" class="hash-link" aria-label="Direct link to Block Layer" title="Direct link to Block Layer">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="zoned-block-devices-core-support">Zoned Block Devices Core Support<a href="#zoned-block-devices-core-support" class="hash-link" aria-label="Direct link to Zoned Block Devices Core Support" title="Direct link to Zoned Block Devices Core Support">​</a></h3>
<p>To allow supported zoned block devices to be exposed as block device files,
enable the block-layer configuration option <code>CONFIG_BLK_DEV_ZONED</code>. This option
is part of the <em>Enable the block layer</em> top menu of <code>make menuconfig</code>.</p>
<div class="container text--center"><figure><img src="/assets/images/linux-config-zbd-2e5d1a6b239c372fbd3e44f5e3282ebe.png" width="640" max-width="100%"><figcaption><em></em></figcaption></figure></div>
<p>Setting this configuration option gives users access to the ZBD interface. If
this configuration option is not set, users do not have access to the ZBD
interface and support for zoned block devices is disabled in all kernel
subsystems that include support for these devices (this includes I/O schedulers,
device mappers, and file systems).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="write-ordering-control">Write Ordering Control<a href="#write-ordering-control" class="hash-link" aria-label="Direct link to Write Ordering Control" title="Direct link to Write Ordering Control">​</a></h2>
<p>For kernels starting with versions 4.16 and up to version 6.9, write operation
ordering control is achieved using the <em>deadline</em> (legacy single queue
block I/O path) and <em>mq-deadline</em> (multi-queue block I/O path) block I/O
schedulers (see <a href="/docs/linux/sched">Write Ordering Control</a>). <em>deadline</em> and
<em>mq-deadline</em> zoned block device support is automatically enabled if the
<code>CONFIG_BLK_DEV_ZONED</code> configuration option is set.</p>
<p>It is mandatory to enable this scheduler for zoned block devices for kernel
versions 4.16 to 6.9. The configuration option <code>CONFIG_MQ_IOSCHED_DEADLINE</code>
enables the <em>mq-deadline</em> scheduler. The configuration option
<code>CONFIG_IOSCHED_DEADLINE</code> enables the <em>deadline</em> scheduler. Both options can be
selected from the <em>IO Schedulers</em> top menu.</p>
<div class="container text--center"><figure><img src="/assets/images/linux-config-sched-70e55f9f3df2c81df464b476b1c4f636.png" width="640" max-width="100%"><figcaption><em>I/O scheduler configuration with make menuconfig</em></figcaption></figure></div>
<p>As of kernel version 5.0, support for the legacy block-layer single-queue I/O
path has been removed. Only the <em>mq-deadline</em> scheduler remains. As of kernel
version 5.2, <code>CONFIG_MQ_IOSCHED_DEADLINE</code> is automatically selected when the
<code>CONFIG_BLK_DEV_ZONED</code> configuration option is set.</p>
<p>Strating with kernel 6.10, write ordering control is implemented by the block
I/O layer, outside of the block I/O scheduler, using
<a href="/docs/linux/sched#zone-write-plugging">zone write plugging</a>. This new
implementation still allows using the <em>mq-deadline</em> block I/O scheduler but does
not mandate its use with a zoned block device. That is, the <em>none</em> scheduler can
be used with fast NVMe SSDs supporting the zoned namespace feature.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="device-drivers-configuration">Device Drivers Configuration<a href="#device-drivers-configuration" class="hash-link" aria-label="Direct link to Device Drivers Configuration" title="Direct link to Device Drivers Configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="null_blk-logical-device"><em>null_blk</em> Logical Device<a href="#null_blk-logical-device" class="hash-link" aria-label="Direct link to null_blk-logical-device" title="Direct link to null_blk-logical-device">​</a></h3>
<p>The <code>CONFIG_BLK_DEV_ZONED</code> configuration option automatically enables support
for zoned block device emulation that uses the <em>null_blk</em> device driver.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="zbc-and-zac-hard-disks-support">ZBC and ZAC Hard-Disks Support<a href="#zbc-and-zac-hard-disks-support" class="hash-link" aria-label="Direct link to ZBC and ZAC Hard-Disks Support" title="Direct link to ZBC and ZAC Hard-Disks Support">​</a></h3>
<p>SCSI subsystem support for ZBC and ZAC SMR disks is automatically enabled with
the <code>CONFIG_BLK_DEV_ZONED</code> configuration option.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nvme-zoned-namespace-solid-state-disks-support">NVMe Zoned Namespace Solid State Disks Support<a href="#nvme-zoned-namespace-solid-state-disks-support" class="hash-link" aria-label="Direct link to NVMe Zoned Namespace Solid State Disks Support" title="Direct link to NVMe Zoned Namespace Solid State Disks Support">​</a></h3>
<p>The NVM Express Zoned Namespace Command Set depends on <code>CONFIG_BLK_DEV_ZONED</code>
and <code>CONFIG_NVME_CORE</code>. It is automatically built if both of these configuration
options are enabled.</p>
<p>This driver requires the device to support the Zone Append command to
successfully bind to a zoned namespace. It does not support Zone Excursions.
See <a href="/docs/introduction/zns">Zoned Namespace (ZNS) SSDs</a> for more details about
these features.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="device-mapper">Device Mapper<a href="#device-mapper" class="hash-link" aria-label="Direct link to Device Mapper" title="Direct link to Device Mapper">​</a></h2>
<p>Zoned block device support for the device mapper subsystem is automatically
enabled when the <code>CONFIG_BLK_DEV_ZONED</code> option is set. This enables support for
<em>dm-linear</em> and <em>dm-flakey</em> targets. Note that the <em>dm-zoned</em> device mapper
target must be enabled to be usable.</p>
<p>Enable the <em>dm-zoned</em> target by selecting the <code>CONFIG_DM_ZONED</code> option from the
menu <em>Device Drivers --&gt; Multiple devices driver support (RAID and LVM) --&gt;
Device mapper support --&gt; Drive-managed zoned block device target support</em>.</p>
<div class="container text--center"><figure><img src="/assets/images/linux-config-dm-9e8a3c8f8b9a480f921d7d263a9dc113.png" width="640" max-width="100%"><figcaption><em>dm-zoned device mapper target configuration with make menuconfig</em></figcaption></figure></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-systems">File Systems<a href="#file-systems" class="hash-link" aria-label="Direct link to File Systems" title="Direct link to File Systems">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="f2fs"><em>f2fs</em><a href="#f2fs" class="hash-link" aria-label="Direct link to f2fs" title="Direct link to f2fs">​</a></h3>
<p>Support for zoned block devices in the <a href="/docs/filesystems/f2fs"><em>f2fs</em> file system</a>
is automatically enabled with the <code>CONFIG_BLK_DEV_ZONED</code> configuration option.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="zonefs"><em>zonefs</em><a href="#zonefs" class="hash-link" aria-label="Direct link to zonefs" title="Direct link to zonefs">​</a></h3>
<p>Enable compilation of the <em>zonefs</em> file system by selecting the
<code>CONFIG_ZONEFS_FS</code> option from the menu <em>File systems -&gt; zonefs filesystem
support</em>. This option is available only if the <code>CONFIG_BLK_DEV_ZONED</code> option is
set to enable zoned block device support.</p>
<div class="container text--center"><figure><img src="/assets/images/linux-config-zonefs-34a6f41797ebee8de18ee798e45eb6ea.png" width="640" max-width="100%"><figcaption><em>zonefs filesystem configuration with make menuconfig</em></figcaption></figure></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kernel-compilation">Kernel Compilation<a href="#kernel-compilation" class="hash-link" aria-label="Direct link to Kernel Compilation" title="Direct link to Kernel Compilation">​</a></h2>
<p>The kernel compilation process is the same regardless of whether the kernel has
been configured to enable zoned block device support. When the kernel has been
configured to enable zoned block device support, the following commands will
build the kernel.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ make all</span><br></span></code></pre></div></div>
<p>The kernel build infrastructure also allows you to build <em>.rpm</em> or <em>i.deb</em>
packages. To build RPM packages, use the following command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ make rpm-pkg</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kernel-installation">Kernel Installation<a href="#kernel-installation" class="hash-link" aria-label="Direct link to Kernel Installation" title="Direct link to Kernel Installation">​</a></h2>
<p>The procedure for installing a zoned-block-device-enabled kernel is the same as
the procedure for installing a regular kernel. Use the following command to
install the kernel locally.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo make modules_install install</span><br></span></code></pre></div></div>
<p>Follow this command by configuring the system bootloader (if your distribution
requires it). Some distributions might not require you to configure the system
bootloader.</p>
<p>Then restart the host system to execute the newly-compiled and newly-installed
kernel, on which you have enabled support for zoned block devices.</p>
<p>At this point in the installation process, we highly recommend reinstalling the
kernel headers. By reinstalling the kernel headers, the file
<em>/usr/include/linux/blkzoned.h</em> will be installed, which will allow applications
to be compiled against the <a href="/docs/linux/zbd-api">zoned block device API</a>
supported by the kernel.</p>
<p>Run the following command to install the kernel user header files.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo make headers_install</span><br></span></code></pre></div></div>
<p>See the kernel&#x27;s <code>make help</code> output for more information on this directive.</p>
<p>After the the kernel user header files have been installed, we recommend that
you recompile from source any package that will be used to manage and access
zoned block devices. In particular, recompiling and re-installing
<a href="/docs/tools/util-linux">Linux system utilities</a> is highly recommended because
many packages rely on <em>util-linux</em> zoned block device features (e.g. file
systems that use <em>libblkid</em>).</p>
<p>The installation of the kernel and the installation of the user header files can
be simplified by using the RPM packages that are generated with the <code>make rpm-pkg</code> command. If you install all of the packages generated by that command,
you will install the kernel core itself, the associated driver modules, and the
user API herder files. The RPM package <code>kernel-headers-&lt;version&gt;.&lt;arch&gt;.rpm</code>
must be installed in order for the kernel user API header files to be updated.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/linux/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Linux Kernel Zoned Storage Support</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/linux/zbd-api"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Zoned Block Device User Interface</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#block-layer" class="table-of-contents__link toc-highlight">Block Layer</a><ul><li><a href="#zoned-block-devices-core-support" class="table-of-contents__link toc-highlight">Zoned Block Devices Core Support</a></li></ul></li><li><a href="#write-ordering-control" class="table-of-contents__link toc-highlight">Write Ordering Control</a></li><li><a href="#device-drivers-configuration" class="table-of-contents__link toc-highlight">Device Drivers Configuration</a><ul><li><a href="#null_blk-logical-device" class="table-of-contents__link toc-highlight"><em>null_blk</em> Logical Device</a></li><li><a href="#zbc-and-zac-hard-disks-support" class="table-of-contents__link toc-highlight">ZBC and ZAC Hard-Disks Support</a></li><li><a href="#nvme-zoned-namespace-solid-state-disks-support" class="table-of-contents__link toc-highlight">NVMe Zoned Namespace Solid State Disks Support</a></li></ul></li><li><a href="#device-mapper" class="table-of-contents__link toc-highlight">Device Mapper</a></li><li><a href="#file-systems" class="table-of-contents__link toc-highlight">File Systems</a><ul><li><a href="#f2fs" class="table-of-contents__link toc-highlight"><em>f2fs</em></a></li><li><a href="#zonefs" class="table-of-contents__link toc-highlight"><em>zonefs</em></a></li></ul></li><li><a href="#kernel-compilation" class="table-of-contents__link toc-highlight">Kernel Compilation</a></li><li><a href="#kernel-installation" class="table-of-contents__link toc-highlight">Kernel Installation</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/zoned-storage">Introduction to Zoned Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started with Zoned Storage</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.element.io/#/room/#zonedstorage-general:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/westerndigitalcorporation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Organization<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Western Digital
	Corporation or its affiliates. All rights reserved.<br> By using this site, you agree to the <a href="https://www.westerndigital.com/legal/terms-of-use" target="_blank">Terms of Use</a> and <a href="https://www.westerndigital.com/legal/privacy-statement" target="_blank">Privacy Statement</a>.  All example scripts and program snippets on this site are licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CCO 1.0 Universal</a> license.<br>This site is built with <a href="https://docusaurus.io/" target="_blank">Docusaurus</a>.</div></div></div></footer></div>
</body>
</html>