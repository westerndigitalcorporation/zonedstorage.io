(self.webpackChunkzonedstorage_io=self.webpackChunkzonedstorage_io||[]).push([[491],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return r},kt:function(){return f}});var A=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(e);t&&(A=A.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,A)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,A,s=function(e,t){if(null==e)return{};var n,A,s={},a=Object.keys(e);for(A=0;A<a.length;A++)n=a[A],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(A=0;A<a.length;A++)n=a[A],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var c=A.createContext({}),l=function(e){var t=A.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},r=function(e){var t=l(e.components);return A.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return A.createElement(A.Fragment,{},t)}},p=A.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,c=e.parentName,r=o(e,["components","mdxType","originalType","parentName"]),p=l(n),f=s,g=p["".concat(c,".").concat(f)]||p[f]||d[f]||a;return n?A.createElement(g,i(i({ref:t},r),{},{components:n})):A.createElement(g,i({ref:t},r))}));function f(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,i=new Array(a);i[0]=p;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:s,i[1]=o;for(var l=2;l<a;l++)i[l]=n[l];return A.createElement.apply(null,i)}return A.createElement.apply(null,n)}p.displayName="MDXCreateElement"},7993:function(e,t,n){"use strict";var A=n(7294);t.Z=function(e){var t=e.src,s=e.title;return A.createElement("div",{className:"container text--center"},A.createElement("figure",null,A.createElement("img",{src:n(7356)("./"+t).default,width:"640","max-width":"100%"}),A.createElement("figcaption",null,A.createElement("em",null,s))))}},3195:function(e,t,n){"use strict";n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return g},frontMatter:function(){return c},metadata:function(){return r},toc:function(){return p}});var A=n(3117),s=n(102),a=(n(7294),n(3905)),i=n(7993),o=["components"],c={id:"zbc-tests",title:"ZBC/ZAC Compliance Tests",sidebar_label:"ZBC/ZAC Compliance Tests"},l="ZBC/ZAC Compliance Tests",r={unversionedId:"tests/zbc-tests",id:"tests/zbc-tests",title:"ZBC/ZAC Compliance Tests",description:"Developers may face many problems with an application development if the system",source:"@site/docs/tests/zbc-tests.md",sourceDirName:"tests",slug:"/tests/zbc-tests",permalink:"/docs/tests/zbc-tests",tags:[],version:"current",frontMatter:{id:"zbc-tests",title:"ZBC/ZAC Compliance Tests",sidebar_label:"ZBC/ZAC Compliance Tests"},sidebar:"docs",previous:{title:"Overview",permalink:"/docs/tests"},next:{title:"Kernel Block Layer Tests",permalink:"/docs/tests/blktests"}},d={},p=[{value:"<em>libzbc</em> Conformance Test Suite",id:"libzbc-conformance-test-suite",level:2},{value:"Checking Serial ATA Disks",id:"checking-serial-ata-disks",level:2},{value:"Checking SAS Disks",id:"checking-sas-disks",level:2},{value:"Checking the Kernel SCSI-To-ATA Translation Layer",id:"checking-the-kernel-scsi-to-ata-translation-layer",level:2},{value:"Checking the HBA SCSI-TO-ATA Translation Layer",id:"checking-the-hba-scsi-to-ata-translation-layer",level:2}],f={toc:p};function g(e){var t=e.components,n=(0,s.Z)(e,o);return(0,a.kt)("wrapper",(0,A.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"zbczac-compliance-tests"},"ZBC/ZAC Compliance Tests"),(0,a.kt)("p",null,"Developers may face many problems with an application development if the system\nbeing used has non-compliant components, either software or hardware."),(0,a.kt)("p",null,"The typical problems that can be faced may be due to a SAS HBA not fully\ncompatible with the ZBC and ZAC standards (e.g. The HBA has a defective\ntranslation layer implementation) or the kernel version includes a bug resulting\nfor instance in write commands not being translated correctly or an invalid\ncommand failure processing."),(0,a.kt)("p",null,"Many of these problems can be identified early by executing\n",(0,a.kt)("a",{parentName:"p",href:"/docs/tools/libzbc"},(0,a.kt)("em",{parentName:"a"},"libzbc"))," conformance test suite."),(0,a.kt)("h2",{id:"libzbc-conformance-test-suite"},(0,a.kt)("em",{parentName:"h2"},"libzbc")," Conformance Test Suite"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"libzbc")," implements a test suite primarily aiming at checking that a disk\nfully conforms to the definition and constraints of the ZAC and ZBC standards.\n",(0,a.kt)("em",{parentName:"p"},"libzbc")," test suite works equally well with physical disks (SAS and SATA) as\nwell as emulated disks created with ",(0,a.kt)("a",{parentName:"p",href:"/docs/tools/tcmu-runner"},(0,a.kt)("em",{parentName:"a"},"tcmu-runner")),"."),(0,a.kt)("p",null,"Information on how to compile and install ",(0,a.kt)("em",{parentName:"p"},"libzbc")," with the test suite\nenabled can be found ",(0,a.kt)("a",{parentName:"p",href:"/docs/tools/libzbc"},"here"),"."),(0,a.kt)("p",null,"In this chapter, the following disk configuration is used throughout the\nexamples shown."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# lsscsi -g\n[2:0:0:0]    disk    ATA      INTEL SSDSC2CT18 335u  /dev/sda   /dev/sg0\n[5:0:0:0]    zbc     ATA      HGST HSH721415AL T220  /dev/sdb   /dev/sg1\n[10:0:2:0]   zbc     HGST     HSH721414AL52M0  a220  /dev/sdc   /dev/sg2\n[10:0:3:0]   zbc     ATA      HGST HSH721415AL T220  /dev/sdd   /dev/sg3\n")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"/dev/sdb")," is a SATA disk connected to an AHCI controller (SATA port),\n",(0,a.kt)("em",{parentName:"p"},"/dev/sdc")," is a SAS disk connected to a SAS HBA and ",(0,a.kt)("em",{parentName:"p"},"/dev/sdc")," is a SATA disk\nconnected to the same SAS HBA."),(0,a.kt)("h2",{id:"checking-serial-ata-disks"},"Checking Serial ATA Disks"),(0,a.kt)("p",null,"To check a SATA ZAC disk correct operation and conformance to the ZAC standard,\n",(0,a.kt)("em",{parentName:"p"},"libzbc"),' test suite must be executed using the "--ata" option.'),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},(0,a.kt)("em",{parentName:"p"},"libzbc")," test suite must be executed against the disk SCSI generic node file\n(e.g. ",(0,a.kt)("em",{parentName:"p"},"/dev/sg")," path) to enable the full range of direct SCSI or ATA command\nexecution without any interference from the kernel block I/O stack. ",(0,a.kt)("em",{parentName:"p"},"libzbc"),"\ntest suite will not run if the disk block device file (",(0,a.kt)("em",{parentName:"p"},"/dev/sd"),") is\nspecified."))),(0,a.kt)("p",null,"Using the AHCI connected SATA disk ",(0,a.kt)("em",{parentName:"p"},"/dev/sdb"),", which corresponds to the SCSI\ngeneric node file ",(0,a.kt)("em",{parentName:"p"},"/dev/sg1"),", the execution of the 107 test cases of ",(0,a.kt)("em",{parentName:"p"},"libzbc"),"\ntest suite result in the following output."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# cd libzbc/test\n# ./zbc_test.sh --ata /dev/sg1\nExecuting section 00 - command completion tests...\n    00.010: REPORT_ZONES command completion...                                            [Passed]\n    00.011: REPORT_ZONES (partial bit) command completion...                              [Passed]\n    00.012: REPORT_ZONES (reporting option 0x10) command completion...                    [Passed]\n    00.013: REPORT_ZONES (reporting option 0x11) command completion...                    [Passed]\n    00.014: REPORT_ZONES (reporting option 0x3F) command completion...                    [Passed]\n    00.020: OPEN_ZONE command completion...                                               [Passed]\n    00.030: CLOSE_ZONE command completion...                                              [Passed]\n    00.040: FINISH_ZONE command completion...                                             [Passed]\n    00.050: RESET_WRITE_PTR command completion...                                         [Passed]\n    00.060: WRITE command completion...                                                   [Passed]\n    00.070: READ command completion...                                                    [Passed]\nExecuting section 01 - sense key, sense code tests...\n    01.010: REPORT_ZONES logical block out of range...                                    [Passed]\n    01.011: REPORT_ZONES invalid reporting option...                                      [Passed]\n    01.020: OPEN_ZONE invalid zone start lba...                                           [Passed]\n    01.021: OPEN_ZONE insufficient zone resources...                                      [Passed]\n    01.022: OPEN_ZONE insufficient zone resources (ALL bit set)...                        [Passed]\n    01.023: OPEN_ZONE conventional zone...                                                [Passed]\n    01.024: OPEN zone LBA at End of Medium...                                             [Passed]\n    01.030: CLOSE_ZONE invalid zone start lba...                                          [Passed]\n    01.031: CLOSE_ZONE conventional zone...                                               [Passed]\n    01.032: CLOSE zone LBA at End of Medium...                                            [Passed]\n    01.040: FINISH_ZONE invalid zone start lba...                                         [Passed]\n    01.041: FINISH_ZONE conventional zone...                                              [Passed]\n    01.042: FINISH zone LBA at End of Medium...                                           [Passed]\n    01.050: RESET_WRITE_PTR invalid zone start lba...                                     [Passed]\n    01.051: RESET_WRITE_PTR conventional zone...                                          [Passed]\n    01.052: RESET zone LBA at End of Medium...                                            [Passed]\n    01.060: READ access sequential zone LBAs after write pointer...                       [Passed]\n    01.061: READ sequential zones boundary violation...                                   [Passed]\n    01.062: READ conventional/sequential zones boundary violation...                      [Passed]\n    01.063: READ across write-pointer zones (FULL->FULL)...                               [Passed]\n    01.064: READ access write pointer zone LBAs starting after write pointer...           [Passed]\n    01.070: WRITE unaligned write in sequential zone...                                   [Passed]\n    01.071: WRITE sequential zone boundary violation...                                   [Passed]\n    01.072: WRITE insufficient zone resources...                                          [Passed]\n    01.073: WRITE full zone...                                                            [Passed]\n    01.074: WRITE physical sector unaligned write to sequential zone...                   [Passed]\n    01.075: WRITE unaligned ending below write pointer...                                 [Passed]\n    01.076: WRITE unaligned crossing write pointer...                                     [Passed]\n    01.077: WRITE across zone-type spaces (cross-type boundary violation)...              [Passed]\n    01.080: READ cross-zone FULL->IOPENL and ending above Write Pointer...                [Passed]\n    01.081: READ cross-zone FULL->IOPENL and ending below Write Pointer...                [Passed]\n    01.082: READ cross-zone IOPENH->FULL starting below Write Pointer...                  [Passed]\n    01.083: READ cross-zone IOPENL->FULL starting above Write Pointer...                  [Passed]\n    01.090: WRITE cross-zone FULL->IOPENL and ending above Write Pointer...               [Passed]\n    01.091: WRITE cross-zone FULL->IOPENL and ending below Write Pointer...               [Passed]\n    01.092: WRITE cross-zone IOPENH->FULL starting below Write Pointer...                 [Passed]\n    01.093: WRITE cross-zone IOPENL->FULL starting above Write Pointer...                 [Passed]\n    01.094: WRITE cross-zone FULL->EMPTY...                                               [Passed]\n    01.095: WRITE cross-zone EMPTY->EMPTY starting above Write Pointer...                 [Passed]\nExecuting section 02 - zone state machine tests...\n    02.001: OPEN_ZONE empty to explicit open...                                           [Passed]\n    02.002: CLOSE_ZONE empty to empty...                                                  [Passed]\n    02.003: FINISH_ZONE empty to full...                                                  [Passed]\n    02.004: RESET_WRITE_PTR empty to empty...                                             [Passed]\n    02.005: OPEN_ZONE implicit open to explicit open...                                   [Passed]\n    02.006: CLOSE_ZONE implicit open to closed...                                         [Passed]\n    02.007: FINISH_ZONE implicit open to full...                                          [Passed]\n    02.008: RESET_WRITE_PTR implicit open to empty...                                     [Passed]\n    02.009: OPEN_ZONE empty to explicit open to explicit open...                          [Passed]\n    02.010: CLOSE_ZONE empty to explicit open to empty...                                 [Passed]\n    02.011: FINISH_ZONE empty to explicit open to full...                                 [Passed]\n    02.012: RESET_WRITE_PTR empty to explicit open to empty...                            [Passed]\n    02.013: OPEN_ZONE implicit open to explicit open to explicit open...                  [Passed]\n    02.014: CLOSE_ZONE implicit open to explicit open to closed...                        [Passed]\n    02.015: FINISH_ZONE implicit open to explicit open to full...                         [Passed]\n    02.016: RESET_WRITE_PTR implicit open to explicit open to empty...                    [Passed]\n    02.017: OPEN_ZONE closed to explicit open...                                          [Passed]\n    02.018: CLOSE_ZONE closed to closed...                                                [Passed]\n    02.019: FINISH_ZONE closed to full...                                                 [Passed]\n    02.020: RESET_WRITE_PTR closed to empty...                                            [Passed]\n    02.021: OPEN_ZONE full to full...                                                     [Passed]\n    02.022: CLOSE_ZONE full to full...                                                    [Passed]\n    02.023: FINISH_ZONE full to full...                                                   [Passed]\n    02.024: RESET_WRITE_PTR full to empty...                                              [Passed]\n    02.025: OPEN_ZONE empty to empty (ALL bit set)...                                     [Passed]\n    02.026: CLOSE_ZONE empty to empty (ALL bit set)...                                    [Passed]\n    02.027: FINISH_ZONE empty to empty (ALL bit set)...                                   [Passed]\n    02.028: RESET_WRITE_PTR empty to empty (ALL bit set)...                               [Passed]\n    02.029: OPEN_ZONE implicit open to implicit open (ALL bit set)...                     [Passed]\n    02.030: CLOSE_ZONE implicit open to close (ALL bit set)...                            [Passed]\n    02.031: FINISH_ZONE implicit open to full (ALL bit set)...                            [Passed]\n    02.032: RESET_WRITE_PTR implicit open to empty (ALL bit set)...                       [Passed]\n    02.033: OPEN_ZONE empty to explicit open to explicit open (ALL bit set)...            [Passed]\n    02.034: CLOSE_ZONE empty to explicit open to empty (ALL bit set)...                   [Passed]\n    02.035: FINISH_ZONE empty to explicit open to full (ALL bit set)...                   [Passed]\n    02.036: RESET_WRITE_PTR empty to explicit open to empty (ALL bit set)...              [Passed]\n    02.037: OPEN_ZONE implicit open to explicit open to explicit_open (ALL bit set)...    [Passed]\n    02.038: CLOSE_ZONE implicit open to explicit open to closed (ALL bit set)...          [Passed]\n    02.039: FINISH_ZONE implicit open to explicit open to full (ALL bit set)...           [Passed]\n    02.040: RESET_WRITE_PTR implicit open to explicit open to empty (ALL bit set)...      [Passed]\n    02.041: OPEN_ZONE closed to explicit open (ALL bit set)...                            [Passed]\n    02.042: CLOSE_ZONE closed to closed (ALL bit set)...                                  [Passed]\n    02.043: FINISH_ZONE closed to full (ALL bit set)...                                   [Passed]\n    02.044: RESET_WRITE_PTR closed to empty test (ALL bit set)...                         [Passed]\n    02.045: OPEN_ZONE full to full (ALL bit set)...                                       [Passed]\n    02.046: CLOSE_ZONE full to full (ALL bit set)...                                      [Passed]\n    02.047: FINISH_ZONE full to full (ALL bit set)...                                     [Passed]\n    02.048: RESET_WRITE_PTR full to empty (ALL bit set)...                                [Passed]\n    02.070: WRITE empty to implicit open...                                               [Passed]\n    02.071: WRITE empty to full...                                                        [Passed]\n    02.072: WRITE implicit open to implicit open...                                       [Passed]\n    02.073: WRITE implicit open to full...                                                [Passed]\n    02.074: WRITE closed to implicit open...                                              [Passed]\n    02.075: WRITE closed to full...                                                       [Passed]\n    02.076: WRITE explicit open to explicit open...                                       [Passed]\n    02.077: WRITE explicit open to full...                                                [Passed]\n    02.078: WRITE full to full...                                                         [Passed]\n")),(0,a.kt)("p",null,"The same execution procedure can be applied to the SATA disk ",(0,a.kt)("em",{parentName:"p"},"/dev/sdd"),"\nconnected to the SAS HBA. This disk has the SCSI generic node file ",(0,a.kt)("em",{parentName:"p"},"/dev/sg3"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# cd libzbc/test\n# ./zbc_test.sh --ata /dev/sg3\nExecuting section 00 - command completion tests...\n    00.010: REPORT_ZONES command completion...                            [Passed]\n    00.011: REPORT_ZONES (partial bit) command completion...              [Passed]\n    00.012: REPORT_ZONES (reporting option 0x10) command completion...    [Passed]\n[...]\n    00.070: READ command completion...                                    [Passed]\nExecuting section 01 - sense key, sense code tests...\n    01.010: REPORT_ZONES logical block out of range...                    [Passed]\n[...]\n    01.095: WRITE cross-zone EMPTY->EMPTY starting above Write Pointer... [Passed]\nExecuting section 02 - zone state machine tests...\n    02.001: OPEN_ZONE empty to explicit open...                           [Passed]\n[...]\n    02.077: WRITE explicit open to full...                                [Passed]\n    02.078: WRITE full to full...                                         [Passed]\n")),(0,a.kt)("p",null,"If a test case fails, an error message similar to the example below is shown\nand the test suite stops execution."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# cd libzbc/test\n# ./zbc_test.sh --ata XXX\nExecuting section 00 - command completion tests...\n    00.010: REPORT_ZONES command completion...                            [Passed]\n    00.011: REPORT_ZONES (partial bit) command completion...              [Passed]\n[...]\n    01.095: WRITE cross-zone EMPTY->EMPTY starting above Write Pointer... [Passed]\nExecuting section 02 - zone state machine tests...\n[...]\n    02.078: WRITE full to full...                                         [Failed]\n    => Expected Illegal-request / Invalid-field-in-cdb\n       Got Illegal-request / Unaligned-write-command\n#\n")),(0,a.kt)("p",null,"A test case failure is a strong indicator that the disk may not be fully\ncompliant with the ZAC specifications. Most failures can generally be confirmed\nusing a bus analyzer to obtain a command trace for the failing test sequence.\nOther root cause for any test failure are always a possibility."),(0,a.kt)("h2",{id:"checking-sas-disks"},"Checking SAS Disks"),(0,a.kt)("p",null,"Testing physical SAS disks as well as ",(0,a.kt)("em",{parentName:"p"},"tcmu-runner")," emulated SCSI disks do not\nrequire the ",(0,a.kt)("em",{parentName:"p"},"--ata")," option. Using the SAS disk ",(0,a.kt)("em",{parentName:"p"},"/dev/sg2"),", the test suite output\nis the same as with SATA disks if all tests pass."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# cd libzbc/test\n# ./zbc_test.sh /dev/sg2\nExecuting section 00 - command completion tests...\n    00.010: REPORT_ZONES command completion...                         [Passed]\n    00.011: REPORT_ZONES (partial bit) command completion...           [Passed]\n    00.012: REPORT_ZONES (reporting option 0x10) command completion... [Passed]\n    00.013: REPORT_ZONES (reporting option 0x11) command completion... [Passed]\n    00.014: REPORT_ZONES (reporting option 0x3F) command completion... [Passed]\n    00.020: OPEN_ZONE command completion...                            [Passed]\n[...]\n    02.077: WRITE explicit open to full...                             [Passed]\n    02.078: WRITE full to full...                                      [Passed]\n")),(0,a.kt)("h2",{id:"checking-the-kernel-scsi-to-ata-translation-layer"},"Checking the Kernel SCSI-To-ATA Translation Layer"),(0,a.kt)("p",null,"When ",(0,a.kt)("em",{parentName:"p"},"libzbc"),' test suite is executed with the "--ata" option, ATA commands are\nsent directly to the disk using the SCSI generic driver passthrough facility.\nThese ATA commands are directly embedded into the ATA16 SCSI passthrough\ncommand, allowing to completely bypass the kernel SCSI to ATA translation layer\nimplemented by the kernel ',(0,a.kt)("em",{parentName:"p"},"libata")," component."),(0,a.kt)("p",null,"Executing ",(0,a.kt)("em",{parentName:"p"},"libzbc")," test suite against a SATA disk connected to a SATA port (e.g.\nAn AHCI adapter port) will result in the test suite issuing only SCSI commands\nthat will be translated by the kernel ",(0,a.kt)("em",{parentName:"p"},"libata")," before sending as ATA commands to\nthe disk. That is, the kernel SAT can be exercised."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# cd libzbc/test\n# ./zbc_test.sh /dev/sg1\nExecuting section 00 - command completion tests...\n    00.010: REPORT_ZONES command completion...                         [Passed]\n    00.011: REPORT_ZONES (partial bit) command completion...           [Passed]\n    00.012: REPORT_ZONES (reporting option 0x10) command completion... [Passed]\n[...]\n    02.077: WRITE explicit open to full...                             [Passed]\n    02.078: WRITE full to full...                                      [Passed]\n")),(0,a.kt)("p",null,"If all tests pass, then the kernel SAT layer can be considered as correct. On\nthe other hand, if some tests fails while all tests pass with the ",(0,a.kt)("em",{parentName:"p"},"--ata")," option\nused, then the kernel SAT implementation becomes a candidate as the root cause\nfor the failure. This analysis is summarized in the table below."),(0,a.kt)(i.Z,{src:"tests-zbc-kernel.png",title:"Probable failure root cause with SATA disks on AHCI ports",mdxType:"Image"}),(0,a.kt)("h2",{id:"checking-the-hba-scsi-to-ata-translation-layer"},"Checking the HBA SCSI-TO-ATA Translation Layer"),(0,a.kt)("p",null,"Similarly to the previous case, executing ",(0,a.kt)("em",{parentName:"p"},"libzbc")," test suite without the\n",(0,a.kt)("em",{parentName:"p"},"--ata")," option against a SATA disk connected to a SAS HBA will exercise the HBA\nSCSI to ATA command translation by removing the use of the ATA16 passthrough\ncommand."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plaintext"},"# cd libzbc/test\n# ./zbc_test.sh /dev/sg3\nExecuting section 00 - command completion tests...\n    00.010: REPORT_ZONES command completion...                         [Passed]\n    00.011: REPORT_ZONES (partial bit) command completion...           [Passed]\n    00.012: REPORT_ZONES (reporting option 0x10) command completion... [Passed]\n[...]\n    02.077: WRITE explicit open to full...                             [Passed]\n    02.078: WRITE full to full...                                      [Passed]\n")),(0,a.kt)("p",null,'Again comparing the result of the test suite execution for the two cases (with\nand without the "--ata" option) gives hints on the root cause of eventual test\nfailures. The table below indicates the possible failure root cause when the\ntest suite reports errors.'),(0,a.kt)(i.Z,{src:"tests-zbc-hba.png",title:"Probable failure root cause with SATA disks on SAS HBA",mdxType:"Image"}))}g.isMDXComponent=!0},5:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-linux-zbd-f4ba5756b82ac441113bd7f9c9dd1dc6.png"},8477:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-smr-tracks-2277a1473f60e1e862f8bb5916422533.png"},6020:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-smr-zones-6296257d2459f5d1872bc28dcfa36ccd.png"},6525:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-zns-128e951b7035733479ad228844c9e7ab.png"},3006:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-zone-append-890c07f2624fe7dcf7c5ee61fe2a6f0b.png"},7702:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-zoned-storage-82ce755eb4ac58c0b289d5bcb8b8c361.png"},1328:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/intro-zonesize-vs-capacity-0f94861db037e13632def2968998b611.png"},26:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-dm-9e8a3c8f8b9a480f921d7d263a9dc113.png"},7690:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-pscsi-e7c9db15cc4aebcf65fb21db3521a144.png"},7876:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-sched-70e55f9f3df2c81df464b476b1c4f636.png"},4659:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-tcm1-7684c969474b143f4f71318501623f6f.png"},6245:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-tcm2-6bbd5067f606b5e32db5520dea899278.png"},2623:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-vhost-21cc5561b882aa8097fb30aa35664908.png"},4959:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-zbd-2e5d1a6b239c372fbd3e44f5e3282ebe.png"},4670:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-config-zonefs-34a6f41797ebee8de18ee798e45eb6ea.png"},672:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-dm-zoned-7f01ae74923ff02b8d01c92fef2d376d.png"},4791:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-iopath-3ad49009873f1211b8e873f9ba540a38.png"},530:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/linux-versions-da4843f4c91f84aa8ef57f001bb6e8f1.png"},9889:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/percona-server-logo-93e864d0f923e386d855f6a8ea67fc8f.png"},308:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tests-zbc-hba-4a57d56fc6c4d400eadc1692b1907a27.png"},8695:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tests-zbc-kernel-166564aae2e5ad8dc156175fbf8f2e85.png"},6312:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tools-libzbc-gzbc-5d6b525337b567661f392ef6d06ad83e.png"},8920:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tools-libzbc-9dc574a0bfec08d195e6e4179d6cd272.png"},6925:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tools-libzbd-gzbd-viewer-63527beb07ac767d890a1b9616c85add.png"},5922:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tools-libzbd-gzbd-3a358277b4b4b8a9ea5629ce574afad4.png"},5089:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tools-tcmu-gzbc-11fb58818ee21d5116da8329d0d479af.png"},6479:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/tools-tcmu-dc8b8095c58f25df749406030dcc1b25.png"},9972:function(e,t,n){"use strict";n.r(t),t.default="data:image/vnd.microsoft.icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADRgFkA0YBZGtGAWW/RgFmu0YBZ39GAWf/RgFn/0YBZ/9GAWf/RgFnf0YBZrtGAWW/RgFka0YBZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADRgFkA0YBZP9GAWbbRgFn90YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf3RgFm20YBZP9GAWQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0YBZEtGAWaTRgFn/0YBZ/9GAWf/RgFn/0YBZ/9OGYv/ZnYX/3quY/96tm//booz/1Y1u/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZqtGAWRgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANGAWTXRgFnm0YBZ/9GAWf/RgFn/1Itr/+bCtf/05+L//fv6//r08v/26+j/9urm//nx7v/9+/r/+O/s/+vPxv/YmoL/0YBZ/9GAWf/RgFn/0YBZ5tGAWTUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADRgFlS0YBZ+tGAWf/RgFn/0oRf/+jHvP/8+Pb/8+Ld/+K4qf/Vj3H/0YBa/9GAWf/RgFn/0YBZ/9OGY//erJn/7dbO//z5+P/w29T/1pJ2/9GAWf/RgFn/0YBZ+tGAWVIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0YBZNdGAWfrRgFn/0YBZ/9eWfP/26+f/9ejk/9uijP/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/1Y9y/+3Wzv/79/X/4LCg/9GAWf/RgFn/0YBZ+tGAWTUAAAAAAAAAAAAAAAAAAAAAAAAAANGAWRLRgFnm0YBZ/9GAWf/ZnYX/+/Xz/+rNw//Sg13/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/+Cwn//79/b/5L2v/9GAWf/RgFn/0YBZ5tGAWRIAAAAAAAAAAAAAAADRgFkA0YBZqtGAWf/RgFn/1pJ1//r08v/mw7f/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9ulkf/8+Pb/4LKi/9GAWf/RgFn/0YBZqtGAWQAAAAAAAAAAANGAWT/RgFn/0YBZ/9GBW//z5N//7dPL/9GAWf/RgFn/1Y9y/+vPx//qz8f/6s/H/+rPx//qz8f/6s/H/+rPx//qz8f/6s/H/+rPx//qz8f/6s/H/96tm//RgFn/0YBZ/9+vnf/89/b/15V5/9GAWf/RgFn/0YBZPwAAAADRgFkA0YBZttGAWf/RgFn/47mq//rz8f/Th2X/0YBZ/9GAWf/Ui2z/+vX0//ju7P/qzcX/6s3F/+rNxf/qzcX/6s3F/+rNxf/qzcX/6s3F/+rNxf/qzcX/3qua/9GAWf/RgFn/0YBZ/+zTy//x3df/0YBZ/9GAWf/RgFm20YBZANGAWRrRgFn90YBZ/9GCXP/48O3/4LOj/9GAWf/RgFn/0YBZ/9GAWf/cqJX//fv6/9+xof/Timn/36+f/+XCtv/lwLT/3auZ/9KDX//RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/1Y1u//z49//an4j/0YBZ/9GAWf3RgFka0YBZb9GAWf/RgFn/4LKh//nx7v/RgVv/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/qzsX///////jx7v/oysD/4bWm/+G2qP/qzsb/9ejl/9iag//RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/7NLJ/+zTy//RgFn/0YBZ/9GAWW/RgFmu0YBZ/9KFYP/8+fj//fr5/9OHZP/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9ujjv/58e//4beo/9GAWf/RgFn/0YBZ/9GAWf/aoYv/8+Tg/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/cpZH/+vTx/9GAWf/RgFn/0YBZrtGAWd/RgFn/0YBZ/+7Xz//v2dH/0YFa/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWP/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWP/47uz/0YFb/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9KDXf/9+fj/15V6/9GAWf/RgFnf0YBZ/9GAWf/RgFr/04hm/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/26OO//Xp5f/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ//br6P/erJn/0YBZ/9GAWf/RgFn/0YBZ/9OIZf/9+/r/0oRf/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/ShWH/3amX/+vRyf/37er/2qGM/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/8+Tf/+G1pf/RgFn/0YBZ/9GAWf/RgFn/04hk//79/P/ShWH/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/dqZf/8d7Z//br5//t1c7/4LKi/9KEYP/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/y4dz/4bSk/9GAWf/RgFn/0YBZ/9GAWf/RgFn//fn4/9eWev/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/4riq//Xo5P/aoYz/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ//Hf2v/cp5P/0YBZ/9GAWf/RgFnf0YBZ/9GAWf/26ub/4LCg/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/05+T/15V7/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/04hm/9KDXv/RgFn/0YBZ39GAWa7RgFn/0YBZ/+vQyP/s0cn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ//Xp5v/UjW7/0YBZ/9GAWf/RgFn/0YBZ/9WPcv/htab/0oNf/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/+fHvP/58O3/2Jh//9GAWf/RgFmu0YBZb9GAWf/RgFn/3KaS//r08v/ShWH/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/5sO4/+3Wz//ShGH/0YBZ/9GAWf/RgVr/79rU////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"},51:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/zs-logo-178d9855350307325549778e41354d29.png"},6334:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/medias/tools-libzbd-gzbd-viewer-example-b3b4ef97af02e55f8b536f5b1b3c32d0.mp4"},7356:function(e,t,n){var A={"./intro-linux-zbd.png":5,"./intro-smr-tracks.png":8477,"./intro-smr-zones.png":6020,"./intro-zns.png":6525,"./intro-zone-append.png":3006,"./intro-zoned-storage.png":7702,"./intro-zonesize-vs-capacity.png":1328,"./linux-config-dm.png":26,"./linux-config-pscsi.png":7690,"./linux-config-sched.png":7876,"./linux-config-tcm1.png":4659,"./linux-config-tcm2.png":6245,"./linux-config-vhost.png":2623,"./linux-config-zbd.png":4959,"./linux-config-zonefs.png":4670,"./linux-dm-zoned.png":672,"./linux-iopath.png":4791,"./linux-versions.png":530,"./percona-server-logo.png":9889,"./tests-zbc-hba.png":308,"./tests-zbc-kernel.png":8695,"./tools-libzbc-gzbc.png":6312,"./tools-libzbc.png":8920,"./tools-libzbd-gzbd-viewer-example.mp4":6334,"./tools-libzbd-gzbd-viewer.png":6925,"./tools-libzbd-gzbd.png":5922,"./tools-tcmu-gzbc.png":5089,"./tools-tcmu.png":6479,"./zs-logo.ico":9972,"./zs-logo.png":51};function s(e){var t=a(e);return n(t)}function a(e){if(!n.o(A,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return A[e]}s.keys=function(){return Object.keys(A)},s.resolve=a,e.exports=s,s.id=7356}}]);