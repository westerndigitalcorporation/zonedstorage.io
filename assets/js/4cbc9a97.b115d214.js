(self.webpackChunkzonedstorage_io=self.webpackChunkzonedstorage_io||[]).push([[8136],{7304:(e,n,t)=>{"use strict";t.r(n),t.d(n,{assets:()=>A,contentTitle:()=>d,default:()=>g,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var s=t(7624),a=t(4552),i=t(336);const o={id:"dm",title:"Device Mapper",sidebar_label:"Device Mapper"},d="Device Mapper",r={id:"linux/dm",title:"Device Mapper",description:"Zoned block device support was added to the device mapper subsystem in kernel",source:"@site/docs/linux/dm.md",sourceDirName:"linux",slug:"/linux/dm",permalink:"/docs/linux/dm",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"dm",title:"Device Mapper",sidebar_label:"Device Mapper"},sidebar:"docs",previous:{title:"Zoned Block Device Partition Support",permalink:"/docs/linux/part"},next:{title:"Overview",permalink:"/docs/tests"}},A={},c=[{value:"dm-linear",id:"dm-linear",level:2},{value:"Zoned Block Device Restrictions",id:"zoned-block-device-restrictions",level:3},{value:"Example: Creating a Small Host Managed Disk",id:"example-creating-a-small-host-managed-disk",level:3},{value:"Example: Conventional Zones as a Regular Disk",id:"example-conventional-zones-as-a-regular-disk",level:3},{value:"dm-flakey",id:"dm-flakey",level:2},{value:"Error modes",id:"error-modes",level:3},{value:"Zoned Block Device Restrictions",id:"zoned-block-device-restrictions-1",level:3},{value:"Examples",id:"examples",level:3},{value:"dm-zoned",id:"dm-zoned",level:2},{value:"Design Overview",id:"design-overview",level:3},{value:"On-Disk Format",id:"on-disk-format",level:3},{value:"Read-Write Processing",id:"read-write-processing",level:3},{value:"Random Zone Reclaim",id:"random-zone-reclaim",level:3},{value:"Userspace Tool",id:"userspace-tool",level:3},{value:"Formatting a Target Device",id:"formatting-a-target-device",level:3},{value:"Activating a Target Device",id:"activating-a-target-device",level:3},{value:"Stopping a Target Device",id:"stopping-a-target-device",level:3}];function l(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"device-mapper",children:"Device Mapper"}),"\n",(0,s.jsxs)(n.p,{children:["Zoned block device support was added to the device mapper subsystem in kernel\nversion 4.13. Two existing targets gained support: the ",(0,s.jsx)(n.em,{children:"dm-linear"})," target and\nthe ",(0,s.jsx)(n.em,{children:"dm-flakey"})," target. ZBD support also added a new target driver, ",(0,s.jsx)(n.em,{children:"dm-zoned"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"dm-linear",children:"dm-linear"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"dm-linear"})," target maps a linear range of blocks of the device-mapper device\nonto a linear range on a backend device. ",(0,s.jsx)(n.em,{children:"dm-linear"})," is the basic building\nblock of logical volume managers like ",(0,s.jsx)("a",{href:"http://www.sourceware.org/lvm2/",target:"_blank",children:(0,s.jsx)(n.em,{children:"LVM"})}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"zoned-block-device-restrictions",children:"Zoned Block Device Restrictions"}),"\n",(0,s.jsxs)(n.p,{children:["When used with zoned block devices, the ",(0,s.jsx)(n.em,{children:"dm-linear"})," device that is created will\nalso be a zoned block device with the same zone size as the underlying device.\nSeveral conditions are enforced by the device-mapper core-management code\nduring the creation of a ",(0,s.jsx)(n.em,{children:"dm-linear"})," target device."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All backend devices used to map different ranges of the target device must\nhave the same zone model."}),"\n",(0,s.jsx)(n.li,{children:"If the backend devices are zoned block devices, all devices must have the same\nzone size."}),"\n",(0,s.jsx)(n.li,{children:"The mapped ranges must be zone aligned, that is, partial zone mapping is not\npossible."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"example-creating-a-small-host-managed-disk",children:"Example: Creating a Small Host Managed Disk"}),"\n",(0,s.jsx)(n.p,{children:"This example illustrates how to create a small host-managed disk that uses zone\nranges from a large high capacity host-managed disk. The zone information of\nthe backend device used is shown below."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# cat /sys/block/sdb/queue/zoned\nhost-managed\n# cat /sys/block/sdb/queue/chunk_sectors\n524288\n# blkzone report /dev/sdb\n  start: 0x000000000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000080000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000100000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000180000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  ...\n  start: 0x010580000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x010600000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x010680000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x010700000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  ...\n  start: 0x6d2300000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x6d2380000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To create a ",(0,s.jsx)(n.em,{children:"dm-linear"}),' device named "small-sdb" that joins the first 5\nconventional zones of the backend device with the first 10 sequential zones,\nuse the following command.']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:'# echo "0 2621440 linear /dev/sdb 0\n2621440 5242880 linear /dev/sdb 274726912" | dmsetup create small-sdb\n'})}),"\n",(0,s.jsx)(n.p,{children:"The resulting device zone model is host-managed and has 15 zones, as shown\nbelow."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# cat /sys/block/dm-0/queue/zoned\nhost-managed\n# cat /sys/block/dm-0/queue/chunk_sectors\n524288\n# blkzone report /dev/dm-0\n  start: 0x000000000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000080000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000100000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000180000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000200000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000280000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000300000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000380000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000400000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000480000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000500000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000580000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000600000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000680000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n  start: 0x000700000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 1(em) [type: 2(SEQ_WRITE_REQUIRED)]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The following shows a script that facilitates the creation of ",(0,s.jsx)(n.em,{children:"dm-linear"}),"\ndevices using zone ranges from a single zoned block device. Such small zoned\nblock devices can be used to test application limits (e.g. Disk full\nconditions)."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\nif [ $# -ne 3 ]; then\n\techo "Usage: $0 <disk> <num conv zones> <num seq zones>"\n\texit 1\nfi\n\ndisk="$1"\nnrconv=$2\nnrseq=$3\ndname="$(basename ${disk})"\n\n# Linear table entries: "start length linear device offset"\n# start: starting block in virtual device\n# length: length of this segment\n# device: block device, referenced by the device name or by major:minor\n# offset: starting offset of the mapping on the device\n\nconvlen=$(( nrconv * 524288 ))\nseqlen=$(( nrseq * 524288 ))\n\nif [ ${convlen} -eq 0 ] && [ ${seqlen} -eq 0 ]; then\n\techo "0 zones..."\n\texit 1\nfi\n\nseqofst=$(blkzone report "$1" | grep "SEQ_WRITE_REQUIRED" |\n\t  head -n1 | cut -f1 -d\',\' | cut -f2 -d\':\' | xargs printf "%d\\n")\n\nif [ ${convlen} -gt ${seqofst} ]; then\n\tnrconv=$(( seqofst / 524288 ))\n\techo "Too many conventional zones requested: truncating to $nrconv"\n\tconvlen=${seqofst}\nfi\n\nif [ ${convlen} -eq 0 ]; then\n\techo "0 ${seqlen} linear ${disk} ${seqofst}" | dmsetup create small-${dname}\nelif [ ${seqlen} -eq 0 ]; then\n\techo "0 ${convlen} linear ${disk} 0" | dmsetup create small-${dname}\nelse\n\techo "0 ${convlen} linear ${disk} 0\n\t${convlen} ${seqlen} linear ${disk} ${seqofst}" | dmsetup create small-${dname}\nfi\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-conventional-zones-as-a-regular-disk",children:"Example: Conventional Zones as a Regular Disk"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dm-linear"})," can also be used to aggregate a zoned block device's conventional\nzones together into a target device that will be usable as a regular disk\n(conventional zones can be randomly written). Reusing the previous example\nbackend disk, 524 conventional zones of 524288 sectors (512 B unit) are\navailable. The following command creates a ",(0,s.jsx)(n.em,{children:"dm-linear"})," device joining all\nconventional zones together."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:'# echo "0 274726912 linear /dev/sdb 0" | dmsetup create small-sdb\n'})}),"\n",(0,s.jsx)(n.p,{children:"The target device is again a host-managed disk but contains only conventional\nzones."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# cat /sys/block/dm-0/queue/zoned\nhost-managed\n# cat /sys/block/dm-0/queue/chunk_sectors\n524288\n# blkzone report /dev/dm-0\n  start: 0x000000000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000080000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000100000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x000180000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  ...\n  start: 0x010500000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n  start: 0x010580000, len 0x080000, wptr 0x000000 reset:0 non-seq:0, zcond: 0(nw) [type: 1(CONVENTIONAL)]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Because this zoned block device is composed entirely of conventional zones, all\nsectors are randomly writable and can therefore be used directly with any file\nsystem."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# mkfs.ext4 /dev/dm-0\nmke2fs 1.44.6 (5-Mar-2019)\nCreating filesystem with 34340864 4k blocks and 8585216 inodes\nFilesystem UUID: 3957429a-5dab-4b30-9797-f9736036a47b\nSuperblock backups stored on blocks:\n\t32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,\n\t4096000, 7962624, 11239424, 20480000, 23887872\n\nAllocating group tables: done\nWriting inode tables: done\nCreating journal (262144 blocks): done\nWriting superblocks and filesystem accounting information: done\n\n# mount /dev/dm-0 /mnt\n# ls -l /mnt\ntotal 16\ndrwx------ 2 root root 16384 May 21 17:03 lost+found\n"})}),"\n",(0,s.jsx)(n.p,{children:"Applications that need frequent random updates to their metadata can use such\nsetups to facilitate the implementation of a complex metadata structure. The\nremaining sequential zones of the disk can be used directly by the application\nto store data."}),"\n",(0,s.jsx)(n.h2,{id:"dm-flakey",children:"dm-flakey"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"dm-flakey"})," target is similar to the ",(0,s.jsx)(n.em,{children:"dm-linear"})," target, except that it\nperiodically exhibits unreliable behavior. This target is useful for simulating\nfailing devices during testing. In the case of zoned block devices,\nsimulating write errors to sequential zones can help to debug application\nwrite-pointer management."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dm-flakey"})," works like this: at the time the table is loaded, the device does\nnot generate errors for some seconds (",(0,s.jsx)(n.em,{children:"up"})," time), but then exhibits unreliable\nbehavior for ",(0,s.jsx)(n.em,{children:"down"})," seconds. This cycle then repeats."]}),"\n",(0,s.jsx)(n.h3,{id:"error-modes",children:"Error modes"}),"\n",(0,s.jsx)(n.p,{children:"Several error-simulation behaviors can be configured."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"drop_writes"})," All write I/Os are silently ignored and dropped. Read I/Os\nare handled correctly."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"error_writes"})," All write I/Os are failed with an error signaled. Read I/Os\nare handled correctly."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"corrupt_bio_byte"})," During the ",(0,s.jsx)(n.em,{children:"down"})," time, replace the Nth byte of the\ndata of each read or write block I/O with a specified value."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The default error mode is to fail all I/O requests during the ",(0,s.jsx)(n.em,{children:"down"})," time of the\nsimulation cycle."]}),"\n",(0,s.jsx)(n.h3,{id:"zoned-block-device-restrictions-1",children:"Zoned Block Device Restrictions"}),"\n",(0,s.jsxs)(n.p,{children:["The same restrictions apply that applied for the ",(0,s.jsx)(n.em,{children:"dm-linear"})," target."]}),"\n",(0,s.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dm-linear"})," detailed documentation and usage examples can be found in the kernel\nsource code documentation file ",(0,s.jsx)("a",{href:"https://github.com/torvalds/linux/blob/master/Documentation/device-mapper/dm-flakey.txt",target:"_blank",children:"Documentation/device-mapper/dm-flakey.txt"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"dm-zoned",children:"dm-zoned"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"dm-zoned"}),' device mapper target provides random write access to zoned\nblock devices (ZBC and ZAC compliant devices). It hides the sequential\nwrite constraint of host-managed zoned block devices from the device user\n(the "device user", in this context, is a file system or an application\naccessing a raw block device). This allows the use of applications and file\nsystems that do not have native zoned block device support.']}),"\n",(0,s.jsxs)(n.p,{children:["File systems or applications that can natively support host-managed zoned\nblock devices (e.g. the f2fs file system since kernel 4.10) do not need to\nuse the ",(0,s.jsx)(n.em,{children:"dm-zoned"})," device mapper target."]}),"\n",(0,s.jsx)(n.h3,{id:"design-overview",children:"Design Overview"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dm-zoned"})," implements an on-disk write buffering scheme to handle random\nwrite accesses to sequential write required zones of a zoned block device.\nConventional zones of the backend device are used for buffering random\naccesses, as well as for storing internal metadata."]}),"\n",(0,s.jsxs)(n.p,{children:["The figure below illustrates the ",(0,s.jsx)(n.em,{children:"dm-zoned"})," zone-usage principle."]}),"\n",(0,s.jsx)(i.c,{src:"linux-dm-zoned.png",title:"Zone mapping overview of the dm-zoned device mapper target"}),"\n",(0,s.jsxs)(n.p,{children:["Optionally, since Linux kernel version 5.8.0, an additional regular block\ndevice can be used to provide randomly writable storage, replacing the\nconventional zones of the backend zoned block device for write buffering. With\nthis new version of ",(0,s.jsx)(n.em,{children:"dm-zoned"}),", multiple zoned block devices can also be used\nto increase performance."]}),"\n",(0,s.jsxs)(n.p,{children:["All zones of the device(s) used to back a ",(0,s.jsx)(n.em,{children:"dm-zoned"})," target are separated into\n2 types:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Metadata zones"})," These are randomly-writable zones that are used to store\nmetadata.  Randomly writable zones may be conventional zones or sequential\nwrite preferred zones (host-aware devices only). Metadata zones are not\nreported as usable capacity to the user. If an additional regular block\ndevice is used for write buffering, metadata zones are stored on this\ncache device."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Data zones"})," All remaining zones of the device. The majority of these zones\nare sequential zones, which are used exclusively for storing user data.\nThe conventional zones (or part of the sequential-write-preferred zones\non a host-aware device) may be used also for buffering user random writes.\nUser data may thus be stored either in conventional zone or in a sequential\nzone."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"As shown in the above figure, the target device is divided into chunks that\nhave the same size as the zones of the backing zoned devices. A logical chunk\ncan be mapped to zones of the backing device in different ways."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Conventional or cache zone mapping"})," This is the case for chunk ",(0,s.jsx)(n.em,{children:"A"})," in the\nfigure, which is mapped to the conventional zone ",(0,s.jsxs)(n.em,{children:["C",(0,s.jsx)("sub",{children:"A"})]}),". This is the\ndefault mapping that is initialized when the first write command is issued\nto an empty (unwritten) chunk. As long as a chunk is mapped to a\nconventional zone, any incoming write request can be directly executed\nusing the mapped conventional zone."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sequential zone mapping"})," A chunk can be mapped initially to a\nsequential zone, as shown for the chunk ",(0,s.jsx)(n.em,{children:"C"})," (mapped to the sequential zone\n",(0,s.jsxs)(n.em,{children:["S",(0,s.jsx)("sub",{children:"C"})]})," in the figure). With such a mapping, an already-written\nblock of the chunk cannot be modified directly. To handle this case, the\nnext mapping type is used."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dual conventional-sequential zone mapping"})," Temporarily add a conventional\nzone to the chunk mapping when you need to update data in an already-written\nblock of a chunk that has been mapped to a sequential zone. Any write\nthat targets a written block will be processed using the conventional\nzone instead of the sequential zone."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dm-zoned"})," metadata include a set of bitmaps to track the validity state of\nblocks in the zones of the backing device. Any write-operation execution is\nalways followed by an update to the bitmaps, to mark the written blocks as\nvalid. In the case of the dual conventional-sequential chunk mapping, the\nbitmap for the blocks of the sequential zone is updated to clear the bits\nthat represent the blocks that have been updated with a write in the\nconventional zone. By doing this, incoming reads always have access to the\nlatest version of the block data simply by inspecting the block validity\nbitmaps."]}),"\n",(0,s.jsx)(n.h3,{id:"on-disk-format",children:"On-Disk Format"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dm-zoned"})," exposes a logical device with a sector size of 4096 bytes,\nregardless of the physical-sector size of the zoned block device that is\nused as a backend . This reduces the amount of metadata needed to manage valid\nblocks (blocks written). The on-disk metadata format is as follows:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Super Block"}),": The first block of the first randomly-writable zone that is\nfound contains the super block, which describes the amount and position (on\nthe disk) of metadata blocks."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Mapping-table blocks"}),": After the super block, there is a set of blocks\nthat describes the mapping of (1) the logical chunks of the target logical\ndevice to (2) data zones. The mapping is indexed by logical chunk number, and\neach mapping entry indicates the data zone that stores the chunk data.\nIt can also indicate the zone number of a random zone that is used to\nbuffer random modifications to the chunk data."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Bitmap-storage blocks"}),": After the mapping-table blocks, there is a set of\nblocks used to store bitmaps that indicate the validity of blocks in\nthe data zones. A valid block is any block that was written and not discarded.\nIn a buffered data zone, a block can be valid only (1) in the data zone or (2)\nin the buffer zone."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The device-mapper subsystem uses two sets of metadata zones, to protect\ninternal metadata against corruption in cases of sudden power loss or system\ncrashes. One set (the primary set) is used as the main metadata set. The other\nset (the secondary set) is used as a log. Modified metadata are first written\nto the secondary set. The log that is created by writing to the secondary set\nis validated by writing an updated super block in the secondary set. After\nthis log operation completes, the primary metadata set is updtaed.  This\nensures that one of the sets is always correct."}),"\n",(0,s.jsx)(n.p,{children:"Flush operations are used as a commit point: when a flush operation is\nreceived, metadata activity is temporarily stopped, all dirty metadata\nis logged and updated, and then normal operation resumes. Flush operations\ntemporarily delay write requests and discard requests. Read requests can be\nprocessed while metadata logging is executed."}),"\n",(0,s.jsx)(n.h3,{id:"read-write-processing",children:"Read-Write Processing"}),"\n",(0,s.jsx)(n.p,{children:"In logical chunks that are mapped to random data zones, all write operations\nare processed by writing directly to the data zones. If the mapping zone is\nmapped to a sequential zone, the write operation is processed directly only if\nthe write offset within the logical chunk is equal to the write pointer offset\nwithin the sequential data zone (i.e. the write operation is aligned on the\nzone write pointer). Otherwise, write operations are processed indirectly,\nusing a buffer zone: a randomly writable free data zone is allocated and\nassigned to the chunk that is being accessed in addition to the already-mapped\nsequential data zone. Writing blocks to the buffer zone will invalidate the\nsame blocks in the sequential data zone."}),"\n",(0,s.jsx)(n.p,{children:"Read operations are processed according to the block validity information\nprovided by the bitmaps: valid blocks are read either from the data zone or,\nif the data zone is buffered, from the buffer zone that is assigned to the data zone."}),"\n",(0,s.jsx)(n.h3,{id:"random-zone-reclaim",children:"Random Zone Reclaim"}),"\n",(0,s.jsx)(n.p,{children:'After some time, the limited number of available random zones may be exhausted,\nmaking unaligned writes to unbuffered zones impossible. To avoid this\nsituation, a reclaim process regularly scans used random zones and tries to\n"reclaim" them by (sequentially) copying the valid blocks of the buffer zone to\na free sequential zone. Once the copy completes, the chunk mapping is updated\nto point to the sequential zone and the buffer zone is freed for reuse.'}),"\n",(0,s.jsx)(n.h3,{id:"userspace-tool",children:"Userspace Tool"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"dmzadm"})," command-line utility is used to format backend zoned devices for\nuse with the ",(0,s.jsx)(n.em,{children:"dm-zoned"})," device mapper target. This utility verifies the\ndevice zone model and prepares and writes on-disk ",(0,s.jsx)(n.em,{children:"dm-zoned"})," metadata\naccording to the device's capacity and zone size."]}),"\n",(0,s.jsxs)(n.p,{children:["The source code for the ",(0,s.jsx)(n.em,{children:"dmzadm"})," utility is available as part of\nthe ",(0,s.jsxs)("a",{href:"https://github.com/westerndigitalcorporation/dm-zoned-tools",target:"_blank",children:[(0,s.jsx)(n.em,{children:"dm-zoned-tools"})," project hosted on GitHub"]}),".\nThe project ",(0,s.jsxs)("a",{href:"https://github.com/westerndigitalcorporation/dm-zoned-tools/blob/master/README.md",target:"_blank",children:[(0,s.jsx)(n.em,{children:"README"})," file"]})," provides instructions on how to compile and\ninstall the utility."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.em,{children:"dm-zoned-tools"})," project was formerly hosted on GitHub as part of\nthe ",(0,s.jsx)("a",{href:"https://github.com/hgst",target:"_blank",children:"HGST organization"}),".\n",(0,s.jsx)(n.em,{children:"dm-zoned-tools"})," repository has since then moved to\nthe ",(0,s.jsx)("a",{href:"https://github.com/westerndigitalcorporation/",target:"_blank",children:"Western Digital Corporation organization on GitHub"}),"."]})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"dmzadm"})," detailed usage is as follows."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --help\ndmzadm allows formatting, checking and repairing\na zoned block device for use with the dm-zoned\ndevice mapper.\nUsage: dmzadm <operation> <device(s)> [options]\nOperations\n  --help | -h   : General help message\n  --format      : Format a block device metadata\n  --check       : Check a block device metadata\n  --repair      : Repair a block device metadata\n  --start       : Start the device-mapper target\n  --stop        : Stop the device-mapper target\nDevices\n  For a single device target, a zoned block device\n  must be specified. For a multi-device target, a\n  a list of block devices must be specified, with\n  a regular block device as the first device specified,\n  followed by one or more zoned block devices.\nGeneral options\n  --verbose     : Verbose output\n  --vverbose    : Very verbose output\nFormat operation options\n  --force       : Force overwrite of existing content\n  --label=<str> : Set the target label name to <str>\n  --seq=<num>   : Number of sequential zones reserved\n                  for reclaim. The minimum is 1 and the\n                  default is 16\n"})}),"\n",(0,s.jsx)(n.h3,{id:"formatting-a-target-device",children:"Formatting a Target Device"}),"\n",(0,s.jsx)(n.p,{children:"Formatting a single device target is done using the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --format /dev/<disk name>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["where ",(0,s.jsx)(n.code,{children:"/dev/<disk name>"})," identifies the backend zoned block device to use. An\nexample execution using a SMR hard-disk is shown below:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --format /dev/sdi\n/dev/sdi: 29297213440 512-byte sectors (13970 GiB)\n  Host-managed device\n  55880 zones, offset 0\n  55880 zones of 524288 512-byte sectors (256 MiB)\n  65536 4KB data blocks per zone\nResetting sequential zones\nWriting primary metadata set\n  Writing mapping table\n  Writing bitmap blocks\n  Writing super block to sdi block 0\nWriting secondary metadata set\n  Writing mapping table\n  Writing bitmap blocks\n  Writing super block to sdi block 131072\nSyncing disk\nDone.\n"})}),"\n",(0,s.jsxs)(n.p,{children:["As of Linux kernel v5.8.0, ",(0,s.jsx)(n.em,{children:"dm-zoned"})," can use regular block devices (such as\nSSDs) together with zoned block devices. In this case, conventional zones are\nemulated (so that the regular block device can hold ",(0,s.jsx)(n.em,{children:"dm-zoned"})," metadata and\nbuffering data). When a regular block device is used, the zone-reclaim process\noperates by copying data from emulated conventional zones on the regular block\ndevice to zones of the zoned block device. This dual-drive configuration can\nsignificantly increase the performance of the target device under\nwrite-intensive workloads."]}),"\n",(0,s.jsxs)(n.p,{children:["Use the following command to format a ",(0,s.jsx)(n.em,{children:"dm-zoned"})," target device that uses an\nadditional regular block device (and, optionally, several zoned-block devices):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --format /dev/nvme2n1 /dev/sdi\n/dev/nvme2n1: 976773168 512-byte sectors (465 GiB)\n  Regular block device\n  1864 zones, offset 0\n/dev/sdi: 29297213440 512-byte sectors (13970 GiB)\n  Host-managed device\n  55880 zones, offset 122159104\n  57743 zones of 524288 512-byte sectors (256 MiB)\n  1 runt zone of 24624 512-byte sectors (12 MiB)\n  65536 4KB data blocks per zone\nResetting sequential zones\nWriting primary metadata set\n  Writing mapping table\n  Writing bitmap blocks\n  Writing super block to nvme2n1 block 0\nWriting secondary metadata set\n  Writing mapping table\n  Writing bitmap blocks\n  Writing super block to nvme2n1 block 131072\nWriting tertiary metadata\n  Writing super block to sdi block 0\nSyncing disk\nSyncing disk\nDone.\n"})}),"\n",(0,s.jsxs)(n.p,{children:["(In this example ",(0,s.jsx)(n.code,{children:"/dev/nvme2n1"})," is a NVMe SSD and ",(0,s.jsx)(n.code,{children:"/dev/sdi"})," is a host-managed SMR hard-disk.)"]}),"\n",(0,s.jsx)(n.h3,{id:"activating-a-target-device",children:"Activating a Target Device"}),"\n",(0,s.jsxs)(n.p,{children:["Start the ",(0,s.jsx)(n.em,{children:"dm-zoned"})," target device (that is using a formatted zoned device or\nset of devices) by running ",(0,s.jsx)(n.em,{children:"dmzadm"})," with the ",(0,s.jsx)(n.code,{children:"--start"})," command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --start /dev/sdi\n/dev/sdi: 29297213440 512-byte sectors (13970 GiB)\n  Host-managed device\n  55880 zones, offset 0\n  55880 zones of 524288 512-byte sectors (256 MiB)\n  65536 4KB data blocks per zone\nsdi: starting dmz-sdi uuid 8c505b4b-d1e9-47a7-8e3a-8b1c00317eaf\n"})}),"\n",(0,s.jsx)(n.p,{children:"Confirm the target's activation by looking at the kernel messages:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmesg\n...\ndevice-mapper: zoned metadata: (dmz-sdi): DM-Zoned metadata version 2\ndevice-mapper: zoned metadata: (sdi): Host-managed zoned block device\ndevice-mapper: zoned metadata: (sdi):   29297213440 512-byte logical sectors (offset 0)\ndevice-mapper: zoned metadata: (sdi):   55880 zones of 524288 512-byte logical sectors (offset 0)\ndevice-mapper: zoned metadata: (dmz-sdi):   55880 zones of 524288 512-byte logical sectors\ndevice-mapper: zoned: (dmz-sdi): Target device: 29286727680 512-byte logical sectors (3660840960 blocks)\n"})}),"\n",(0,s.jsx)(n.p,{children:"The target device that was created is a regular disk that can be used with any\nfile system."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# cat /sys/block/dm-0/queue/zoned\nnone\n# mkfs.ext4 /dev/dm-0\nmke2fs 1.45.5 (07-Jan-2020)\nDiscarding device blocks: done                            \nCreating filesystem with 3660840960 4k blocks and 457605120 inodes\nFilesystem UUID: d49ed278-5bca-46c4-8ce2-cec263dd060c\nSuperblock backups stored on blocks: \n\t32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, \n\t4096000, 7962624, 11239424, 20480000, 23887872, 71663616, 78675968, \n\t102400000, 214990848, 512000000, 550731776, 644972544, 1934917632, \n\t2560000000\n\nAllocating group tables: done                            \nWriting inode tables: done                            \nCreating journal (262144 blocks): done\nWriting superblocks and filesystem accounting information: done\n\n# mount /dev/dm-0 /mnt\n# ls -l /mnt\ntotal 16\ndrwx------ 2 root root 16384 Aug 27 15:14 lost+found\n"})}),"\n",(0,s.jsx)(n.p,{children:"For a multi-device target, you must specify the same list of devices that you\nspecified when you formatted them:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --start /dev/nvmen2p1 /dev/sdi\n/dev/nvme2n1: 976773168 512-byte sectors (465 GiB)\n  Regular block device\n  1864 zones, offset 0\n/dev/sdi: 29297213440 512-byte sectors (13970 GiB)\n  Host-managed device\n  55880 zones, offset 122159104\n  57743 zones of 524288 512-byte sectors (256 MiB)\n  1 runt zone of 24624 512-byte sectors (12 MiB)\n  65536 4KB data blocks per zone\nnvme2n1: starting dmz-nvme2n1 uuid ffbd1a3a-d79b-4d7f-bc13-e475a157bc39\n"})}),"\n",(0,s.jsx)(n.p,{children:"Check the kernel messages to confirm the activation of the target device. This\nis similar to confirming target-device activiation in the single-device case."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"device-mapper: zoned metadata: (dmz-nvme2n1): DM-Zoned metadata version 2\ndevice-mapper: zoned metadata: (nvme2n1): Regular block device\ndevice-mapper: zoned metadata: (nvme2n1):   976773168 512-byte logical sectors (offset 0)\ndevice-mapper: zoned metadata: (nvme2n1):   1864 zones of 524288 512-byte logical sectors (offset 0)\ndevice-mapper: zoned metadata: (sdi): Host-managed zoned block device\ndevice-mapper: zoned metadata: (sdi):   29297213440 512-byte logical sectors (offset 977272832)\ndevice-mapper: zoned metadata: (sdi):   55880 zones of 524288 512-byte logical sectors (offset 1864)\ndevice-mapper: zoned metadata: (dmz-nvme2n1):   57744 zones of 524288 512-byte logical sectors\ndevice-mapper: zoned: (dmz-nvme2n1): Target device: 30264000512 512-byte logical sectors (3783000064 blocks)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"stopping-a-target-device",children:"Stopping a Target Device"}),"\n",(0,s.jsxs)(n.p,{children:["Use the ",(0,s.jsx)(n.code,{children:"--stop"})," operation to disable a ",(0,s.jsx)(n.em,{children:"dm-zoned"})," target device:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"# dmzadm --stop /dev/sdX\n"})}),"\n",(0,s.jsx)(n.p,{children:"For a multi-device target, you must specify the same list of devices that you\nspecified when you formatted them."})]})}function g(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},336:(e,n,t)=>{"use strict";t.d(n,{c:()=>a});t(1504);var s=t(7624);const a=function(e){let{src:n,title:a}=e;return(0,s.jsx)("div",{className:"container text--center",children:(0,s.jsxs)("figure",{children:[(0,s.jsx)("img",{src:t(4356)("./"+n).default,width:"640","max-width":"100%"}),(0,s.jsx)("figcaption",{children:(0,s.jsx)("em",{children:a})})]})})}},2124:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-linux-zbd-f4ba5756b82ac441113bd7f9c9dd1dc6.png"},8036:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-smr-tracks-2277a1473f60e1e862f8bb5916422533.png"},5868:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-smr-zones-6296257d2459f5d1872bc28dcfa36ccd.png"},736:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-zns-128e951b7035733479ad228844c9e7ab.png"},9852:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-zone-append-890c07f2624fe7dcf7c5ee61fe2a6f0b.png"},1260:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-zoned-storage-82ce755eb4ac58c0b289d5bcb8b8c361.png"},5188:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/intro-zonesize-vs-capacity-0f94861db037e13632def2968998b611.png"},6792:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-dm-9e8a3c8f8b9a480f921d7d263a9dc113.png"},8500:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-pscsi-e7c9db15cc4aebcf65fb21db3521a144.png"},2692:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-sched-70e55f9f3df2c81df464b476b1c4f636.png"},4244:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-tcm1-7684c969474b143f4f71318501623f6f.png"},8052:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-tcm2-6bbd5067f606b5e32db5520dea899278.png"},2696:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-vhost-21cc5561b882aa8097fb30aa35664908.png"},3709:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-zbd-2e5d1a6b239c372fbd3e44f5e3282ebe.png"},1868:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-config-zonefs-34a6f41797ebee8de18ee798e45eb6ea.png"},6552:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-dm-zoned-7f01ae74923ff02b8d01c92fef2d376d.png"},9949:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-iopath-3ad49009873f1211b8e873f9ba540a38.png"},3040:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/linux-versions-da4843f4c91f84aa8ef57f001bb6e8f1.png"},1508:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/percona-server-logo-93e864d0f923e386d855f6a8ea67fc8f.png"},8503:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/qemu-151192c8ad3d711f862c27b8b9e5bec4.png"},4020:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tests-zbc-hba-4a57d56fc6c4d400eadc1692b1907a27.png"},700:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tests-zbc-kernel-166564aae2e5ad8dc156175fbf8f2e85.png"},4560:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tools-libzbc-gzbc-5d6b525337b567661f392ef6d06ad83e.png"},2116:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tools-libzbc-9dc574a0bfec08d195e6e4179d6cd272.png"},8312:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tools-libzbd-gzbd-viewer-63527beb07ac767d890a1b9616c85add.png"},6288:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tools-libzbd-gzbd-3a358277b4b4b8a9ea5629ce574afad4.png"},511:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tools-tcmu-gzbc-11fb58818ee21d5116da8329d0d479af.png"},1448:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/tools-tcmu-dc8b8095c58f25df749406030dcc1b25.png"},464:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s="data:image/vnd.microsoft.icon;base64,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WP/47uz/0YFb/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9KDXf/9+fj/15V6/9GAWf/RgFnf0YBZ/9GAWf/RgFr/04hm/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/26OO//Xp5f/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ//br6P/erJn/0YBZ/9GAWf/RgFn/0YBZ/9OIZf/9+/r/0oRf/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/ShWH/3amX/+vRyf/37er/2qGM/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/8+Tf/+G1pf/RgFn/0YBZ/9GAWf/RgFn/04hk//79/P/ShWH/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/dqZf/8d7Z//br5//t1c7/4LKi/9KEYP/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/y4dz/4bSk/9GAWf/RgFn/0YBZ/9GAWf/RgFn//fn4/9eWev/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/4riq//Xo5P/aoYz/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ//Hf2v/cp5P/0YBZ/9GAWf/RgFnf0YBZ/9GAWf/26ub/4LCg/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/05+T/15V7/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/04hm/9KDXv/RgFn/0YBZ39GAWa7RgFn/0YBZ/+vQyP/s0cn/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ//Xp5v/UjW7/0YBZ/9GAWf/RgFn/0YBZ/9WPcv/htab/0oNf/9GAWf/RgFn/0YBZ/9GAWf/RgFn/0YBZ/+fHvP/58O3/2Jh//9GAWf/RgFmu0YBZb9GAWf/RgFn/3KaS//r08v/ShWH/0YBZ/9GAWf/RgFn/0YBZ/9GAWf/RgFn/5sO4/+3Wz//ShGH/0YBZ/9GAWf/RgVr/79rU////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"},3423:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/zs-logo-178d9855350307325549778e41354d29.png"},3048:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/medias/tools-libzbd-gzbd-viewer-example-b3b4ef97af02e55f8b536f5b1b3c32d0.mp4"},5936:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>s});const s=t.p+"assets/images/zone-state-machine-de3050d6565c6840b72bd055dbe01f3b.svg"},4356:(e,n,t)=>{var s={"./intro-linux-zbd.png":2124,"./intro-smr-tracks.png":8036,"./intro-smr-zones.png":5868,"./intro-zns.png":736,"./intro-zone-append.png":9852,"./intro-zoned-storage.png":1260,"./intro-zonesize-vs-capacity.png":5188,"./linux-config-dm.png":6792,"./linux-config-pscsi.png":8500,"./linux-config-sched.png":2692,"./linux-config-tcm1.png":4244,"./linux-config-tcm2.png":8052,"./linux-config-vhost.png":2696,"./linux-config-zbd.png":3709,"./linux-config-zonefs.png":1868,"./linux-dm-zoned.png":6552,"./linux-iopath.png":9949,"./linux-versions.png":3040,"./percona-server-logo.png":1508,"./qemu.png":8503,"./tests-zbc-hba.png":4020,"./tests-zbc-kernel.png":700,"./tools-libzbc-gzbc.png":4560,"./tools-libzbc.png":2116,"./tools-libzbd-gzbd-viewer-example.mp4":3048,"./tools-libzbd-gzbd-viewer.png":8312,"./tools-libzbd-gzbd.png":6288,"./tools-tcmu-gzbc.png":511,"./tools-tcmu.png":1448,"./zone-state-machine.svg":5936,"./zs-logo.ico":464,"./zs-logo.png":3423};function a(e){var n=i(e);return t(n)}function i(e){if(!t.o(s,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=i,e.exports=a,a.id=4356},4552:(e,n,t)=>{"use strict";t.d(n,{I:()=>d,M:()=>o});var s=t(1504);const a={},i=s.createContext(a);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);